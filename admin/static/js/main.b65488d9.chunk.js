(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5599:function(e,t,a){e.exports=a(6e3)},5997:function(e,t){},6000:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(36),i=a.n(o),l=a(13),c=a(14),s=a(16),d=a(15),u=a(17),h=a(3),p=a(45),m=a(189),g=a(1),f=a(12),b=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={menuEl:null},a.handleMenu=a.handleMenu.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),a.handleLogOut=a.handleLogOut.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleMenu",value:function(e){this.setState({menuEl:e.currentTarget})}},{key:"handleClose",value:function(){this.setState({menuEl:null})}},{key:"handleLogOut",value:function(){window.confirm("Est\xe1 seguro de cerrar sesi\xf3n?")&&this.props.onLogOut(),this.handleClose()}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.store,n=e.user,o=this.state.menuEl,i=Boolean(o);return r.a.createElement(g.a,{position:"fixed",style:{zIndex:1201}},r.a.createElement(g.K,{style:{display:"flex",flexDirection:"row"}},r.a.createElement(g.L,{style:{flexGrow:1},variant:"h4",color:"inherit"},t||""),r.a.createElement("div",{style:{display:"block",textAlign:"right"}},r.a.createElement(g.L,{color:"inherit",variant:"button"},(a.titulo||"").toUpperCase()),r.a.createElement(g.L,{color:"inherit",variant:"caption"},n)),r.a.createElement("div",null,r.a.createElement(g.r,{title:a.titulo,"aria-owns":i?"menu-appbar":void 0,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},r.a.createElement(f.a,null)),r.a.createElement(g.x,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:this.handleClose},r.a.createElement(g.y,{style:{minWidth:150},onClick:this.handleLogOut},"Salir")))))}}]),t}(r.a.PureComponent),v=function(e){var t=e.STEPS,a=e.current_step;return r.a.createElement(g.o,{variant:"permanent",style:{maxWidth:200}},r.a.createElement("div",{style:{paddingTop:70,width:200}},r.a.createElement(g.t,null,t.map(function(e,t){return r.a.createElement(r.a.Fragment,{key:t},e.addDividerBefore&&r.a.createElement(g.n,null),r.a.createElement(g.u,{component:p.b,to:"/"+e.id,selected:e.id===a,button:!0},r.a.createElement(g.w,null,e.title),r.a.createElement(g.v,null,r.a.createElement(e.Icon,null))))}))))},E=a(9),O=a(48),y=a(94),C=a(355),j=a.n(C),k="https://orders.runfoodapp.com",S={lat:-.180653,lng:-78.467834},w=(new Date).toString()+":"+Math.floor(1e5+9e5*Math.random());function I(e){e?window.localStorage.setItem("__",JSON.stringify(e)):window.localStorage.removeItem("__")}function T(){var e=window.localStorage.getItem("__");if(e)return(e=JSON.parse(e)).position||(e.position=S),e}function L(){var e=T();if(!e)throw window.location.reload(),{message:"Necesitas iniciar sesi\xf3n para entrar aqu\xed."};return e.token+"+"+w}var x,A={ON_ORDERS_CHANGED:[]};function P(e,t){var a={method:"GET",cache:"reload",mode:"cors",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}};if(t&&t.headers){for(var n in t.headers)a.headers[n]=t.headers[n];delete t.headers}return fetch(e,Object(E.a)({},a,t)).then(function(e){return e.ok?e.json():e.clone().json().catch(function(){return e.text().then(function(t){throw{message:t,status:e.status,statusText:e.statusText}})}).then(function(t){throw Object(E.a)({},t,{status:e.status,statusText:e.statusText})})}).catch(function(e){if("Failed to fetch"===e.message)throw{message:"Este servicio no se encuentra disponible por el momento. Intentelo m\xe1s tarde.",status:0};throw e.message||(e.message=e.statusText),e})}var D={LogIn:function(e){return P("".concat(k,"/login"),{body:JSON.stringify(e),method:"POST"}).catch(function(e){if(400===e.status)throw Object(E.a)({},e,{message:"Usuario o contrase\xf1a incorrectos."});if(401===e.status)throw Object(E.a)({},e);if(401===e.status)throw Object(E.a)({},e)})},GetOrders:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/order?").concat(new URLSearchParams(e).toString()),{headers:{Authorization:"Basic "+btoa(L())}})},GetOrder:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/order/").concat(e),{headers:{Authorization:"Basic "+btoa(L())}})},OrdersOnRoute:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/order-actions/ON-ROUTE"),{method:"POST",body:JSON.stringify({orders:e}),headers:{Authorization:"Basic "+btoa(L())}})},OrdersDelivered:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/order-actions/DELIVERED"),{method:"POST",body:JSON.stringify({orders:e}),headers:{Authorization:"Basic "+btoa(L())}})},ListenOnOrderChange:function(e){return A.ON_ORDERS_CHANGED.push(e),function(){return A.ON_ORDERS_CHANGED.splice(A.ON_ORDERS_CHANGED.indexOf(e),1)}},GetGroups:function(){return P("".concat(k,"/data/").concat(this.storeID,"/group?admin_info=true"),{headers:{Authorization:"Basic "+btoa(L())}})},SaveGroup:function(e){var t=e.id;return P("".concat(k,"/data/").concat(this.storeID,"/group").concat(t?"/".concat(t):""),{method:t?"PUT":"POST",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},RequestActionGroup:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/group/").concat(e.id),{method:"PATCH",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},DeleteGroup:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/group/").concat(e.id),{method:"DELETE",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},GetProduct:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/product/").concat(e,"?admin_info=true"),{headers:{Authorization:"Basic "+btoa(L())}})},SaveProduct:function(e){var t=e.id&&"NUEVO"!==e.id&&e.id;return P("".concat(k,"/data/").concat(this.storeID,"/product").concat(t?"/".concat(t):""),{method:t?"PUT":"POST",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},RequestActionProduct:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/product/").concat(e.id),{method:"PATCH",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},DeleteProduct:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/product/").concat(e.id),{method:"DELETE",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},GetConfigInfo:function(){return P("".concat(k,"/data/").concat(this.storeID,"/config"),{headers:{Authorization:"Basic "+btoa(L())}})},setConfigInfo:function(e){return P("".concat(k,"/data/").concat(this.storeID,"/config"),{method:"POST",body:JSON.stringify(e),headers:{Authorization:"Basic "+btoa(L())}})},START_LISTENING:function(){x=j()(k,{query:{token:btoa(L())},reconnection:!0,transports:["polling"]}),console.info("SOCKET CONNECTED"),x.on("ORDERS_CHANGED",function(e){e.origin!==btoa(L())&&A.ON_ORDERS_CHANGED.forEach(function(t){return t(e.payload,!e.deletedAt)})})},STOP_LISTENING:function(){x&&x.disconnect(),console.info("SOCKET DISCONNECTED")}},N=a(37),R=r.a.createContext({porcentajeIVA:12}),M=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={data:null,error:null},a.close=a.close.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.GetOrder(this.props.match.params.id).then(function(t){return e.setState({data:t})}).catch(function(t){return e.setState({error:t})})}},{key:"close",value:function(){this.props.history.goBack()}},{key:"render",value:function(){var e=this.context&&this.context.porcentajeIVA||12,t=this.state,a=t.data,n=t.error;if(!a)return r.a.createElement(g.j,{open:!0,onClose:this.close},r.a.createElement(g.l,{style:{minWidth:400,height:400}},n?r.a.createElement("div",{style:{textAlign:"center",padding:20}},r.a.createElement(g.L,{variant:"h6"},"Ocurri\xf3 un error"),r.a.createElement(g.L,{variant:"body2"},n.message),r.a.createElement(g.L,{variant:"button"},n.status," ",n.statusText)):r.a.createElement("div",{style:{textAlign:"center",padding:100}},r.a.createElement(g.i,{size:100}),r.a.createElement(g.L,{variant:"h6"},"CARGANDO..."))));var o=a.documento_factura&&a.identificacion_factura,i=Object(N.a)(a.detalle);a.valor_delivery&&i.push({id:"DOMICILIO",pvp:a.valor_delivery,cantidad:1,pagaIva:!1});var l=i.reduce(function(t,a){var n=a.pvp*a.cantidad;return t.cantidad+=a.cantidad,t.neto+=n,a.pagaIva&&(t.iva+=n*e/100),t},{cantidad:0,neto:0,iva:0});l.total=(l.neto+l.iva).round(2);var c=[];a.mts_delivery&&c.push("".concat((a.mts_delivery/1e3).round(1)," km")),a.segs_delivery&&c.push("".concat((a.segs_delivery/60).round(1)," min")),c=c.length?c.join(" / "):"";var s=function(e){if(!e)return;var t=new Date(e);return t.toDateString()+" "+t.toLocaleTimeString()}(a.fechaEnvio||a.createdAt);return r.a.createElement(g.j,{open:!0,onClose:this.close},r.a.createElement(g.l,{style:{minWidth:400,height:400}},r.a.createElement(g.L,{style:{textAlign:"center"},variant:"h5"},"ORDEN #",a.numero),r.a.createElement("div",null,r.a.createElement(g.L,{style:{display:"inline-block",width:90},variant:"body2"},"FECHA: "),r.a.createElement(g.L,{style:{display:"inline-block"},variant:"body1"},s)),r.a.createElement("div",null,r.a.createElement(g.L,{style:{display:"inline-block",width:90},variant:"body2"},"CLIENTE: "),r.a.createElement(g.L,{style:{display:"inline-block"},variant:"body1"},a.nombre)),(a.Documento||a.identificacion)&&r.a.createElement("div",null,r.a.createElement(g.L,{style:{display:"inline-block",width:90},variant:"body2"},a.Documento||"C.I. / RUC",": "),r.a.createElement(g.L,{style:{display:"inline-block"},variant:"body1"},a.identificacion)),r.a.createElement("div",null,r.a.createElement(g.L,{style:{display:"inline-block",width:90},variant:"body2"},"TLF: "),r.a.createElement(g.L,{style:{display:"inline-block"},variant:"body1"},a.telefono)),r.a.createElement("div",null,r.a.createElement(g.L,{style:{display:"inline-block",width:90},variant:"body2"},"DIRECCION: "),r.a.createElement(g.L,{style:{display:"inline-block"},variant:"body1"},a.direccion)),r.a.createElement("div",null,r.a.createElement(g.L,{style:{display:"inline-block",width:90},variant:"body2"},"REFERENCIA: "),r.a.createElement(g.L,{style:{display:"inline-block"},variant:"body1"},a.referencia)),r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row"}},r.a.createElement(g.L,{style:{flex:1,marginRight:10},variant:"h6"},"PRODUCTO"),r.a.createElement(g.L,{style:{width:60,marginRight:10},variant:"h6"},"CANT"),r.a.createElement(g.L,{style:{width:70,textAlign:"right"},variant:"h6"},"TOTAL")),a.detalle.map(function(t,a){return r.a.createElement(G,Object.assign({},t,{key:a,porcentajeIVA:e}))}),a.valor_delivery?r.a.createElement(G,{color:"primary",cantidad:1,pvp:a.valor_delivery,descripcion:"ENVIO A DOMICILIO "+c}):null,r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",marginTop:10}},r.a.createElement(g.L,{variant:"h6",style:{flex:1,marginRight:10}},"TOTAL"),r.a.createElement(g.L,{style:{marginRight:10,width:60},variant:"h6"},l.cantidad.round(4)),r.a.createElement(g.L,{style:{width:70,textAlign:"right"},variant:"h6"},"$ ",l.total.toFixed(2))),r.a.createElement(g.n,{style:{marginTop:10}}),r.a.createElement(g.L,null,"PAGO : ",a.FormaPago),a.numeroTransaccion&&r.a.createElement(g.L,null,"# de Comprobante :",a.numeroTransaccion),r.a.createElement(g.L,null,"NOTAS: ",a.nota),o&&r.a.createElement("div",null,r.a.createElement(g.n,{style:{marginTop:10}}),r.a.createElement(g.L,{style:{textAlign:"center",width:"100%"},variant:"h6"},"DATOS DE FACTURACI\xd3N"),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(g.L,{variant:"body2"},a.Documento_factura,":"),r.a.createElement(g.L,{variant:"body2",style:{flex:1,marginLeft:10}},a.identificacion_factura)),r.a.createElement(U,{title:"Razon Social",icon:f.i,text:a.razonsocial_factura}),r.a.createElement(U,{title:"Telefono",icon:f.u,text:a.telefono_factura}),r.a.createElement(U,{title:"Direcci\xf3n",icon:f.r,text:a.direccion_factura}))),r.a.createElement(g.k,null,r.a.createElement(g.b,{variant:"outlined",color:"secondary",onClick:this.close},"SALIR")))}}]),t}(r.a.Component);function G(e){var t=e.pvp*e.cantidad,a=e.pagaIva?t*e.porcentajeIVA/100:0;return r.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row",marginTop:5,marginBottom:5}},r.a.createElement("div",{style:{flex:1,marginRight:10}},r.a.createElement(g.L,{color:e.color||"default",variant:"subtitle2"},e.descripcion),r.a.createElement(g.L,{style:{paddingLeft:10},color:e.color||"default",variant:"body1"},e.nota)),r.a.createElement(g.L,{color:e.color||"default",style:{marginRight:10,width:60},variant:"subtitle2"},e.cantidad.round(4)),r.a.createElement(g.L,{color:e.color||"default",style:{width:70,textAlign:"right"},variant:"subtitle2"},"$ ",(t+a).round(2).toFixed(2)))}function U(e){return r.a.createElement("div",{style:{display:"flex",flexDirection:"row"},title:e.title},r.a.createElement(e.icon,null),r.a.createElement(g.L,{style:{padding:3,flex:1}},e.text))}M.contextType=R;var _=Object(m.g)(function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).handleClick=a.handleClick.bind(Object(h.a)(Object(h.a)(a))),e.onMounted&&e.onMounted(null,e.estado),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(e){e.stopPropagation();var t=e.currentTarget.id;this.props.history.push(this.props.match.path+"/"+t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,n=t.onSelect,o=t.estado,i=t.now,l=t.timeCol,c=a.filter(function(e){return e.estado===o});return r.a.createElement(g.D,{component:"div",style:{display:"flex",flexDirection:"column",height:"calc(100% - 100px)"}},r.a.createElement(g.G,{component:"div",style:{display:"block"}},r.a.createElement(g.H,{component:"div",style:{width:"20%"}},r.a.createElement(g.F,{component:"div",style:{textAlign:"center"}},r.a.createElement(f.k,null)),r.a.createElement(g.F,{component:"div",style:{width:"20%"}},r.a.createElement(g.L,{variant:"button"},"#")),r.a.createElement(g.F,{component:"div",style:{width:"60%"}},r.a.createElement(g.L,{variant:"button"},"Cliente")),r.a.createElement(g.F,{component:"div",style:{width:"20%"}},r.a.createElement(g.L,{variant:"button"},"Hora")))),r.a.createElement(g.E,{component:"div",style:{flex:1,overflow:"auto",display:"block"}},c.map(function(t){return r.a.createElement(F,Object.assign({onClick:e.handleClick,onCheck:n,timeCol:l,key:t.id},t,{now:i}))})),r.a.createElement(m.b,{component:M,path:"".concat(this.props.match.path,"/:id")}))}}]),t}(r.a.PureComponent)),F=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props;return r.a.createElement(g.H,{tabIndex:0,style:{width:"100%",cursor:"pointer"},onContextMenu:e.onContextMenu,selected:e.selected,hover:!0,id:""+e.id,onClick:e.onClick,component:"div"},r.a.createElement(g.F,{component:"div",padding:"checkbox",style:{width:"20%"}},"deliveredAt"===e.timeCol?r.a.createElement(f.k,null):r.a.createElement(g.h,{checked:e.selected||!1,value:""+e.id,onClick:e.onCheck})),r.a.createElement(g.F,{style:{width:"20%"},component:"div",scope:"row"},e.numero),r.a.createElement(g.F,{style:{width:"60%"},component:"div"},e.nombre),r.a.createElement(g.F,{style:{width:"20%"},component:"div",title:new Date(e[e.timeCol]).toLocaleString()},function(e){var t=z(e),a=z(new Date);if(t===a)return B(e);if(t+1===a)return"Ayer "+B(e);if(a>t&&a-t<6)return"Hace "+(a-t)+" dias "+B(e);return e.toLocaleString()}(new Date(e[e.timeCol]))))}}]),t}(r.a.PureComponent);function z(e){var t=new Date(e.getFullYear(),0,0),a=e-t;return Math.floor(a/864e5)}function B(e){var t=e.getHours(),a=e.getMinutes();return"".concat(V(t),":").concat(V(a))}function V(e){return(1===e.toString().length?"0":"")+e.toString()}var J=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={now:(new Date).valueOf(),data:[],loading:!0,goToCenter:null,navigationValue:0},e.onMounted&&e.onMounted(e.stepID),a.handleRightClick=a.handleRightClick.bind(Object(h.a)(Object(h.a)(a))),a.handleSelect=a.handleSelect.bind(Object(h.a)(Object(h.a)(a))),a.handleCurrentLocation=a.handleCurrentLocation.bind(Object(h.a)(Object(h.a)(a))),a.handleNavigation=a.handleNavigation.bind(Object(h.a)(Object(h.a)(a))),a.handleChangeState=a.handleChangeState.bind(Object(h.a)(Object(h.a)(a))),a.__updateRecords=a.__updateRecords.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.GetOrders().then(function(t){e.setState({data:t,loading:!1}),e.REMOVE_LISTENER=D.ListenOnOrderChange(e.__updateRecords)}).catch(function(t){return e.setState({error:t,loading:!1})})}},{key:"componentWillUnmount",value:function(){this.STOP_TIMER&&this.STOP_TIMER(),this.REMOVE_LISTENER&&this.REMOVE_LISTENER()}},{key:"handleRightClick",value:function(e){}},{key:"handleSelect",value:function(e){e.stopPropagation();var t=e.target,a=t.value,n=t.checked;this.setState(function(e){var t=Object(E.a)({},e);t.data=e.data;var r=t.data.find(function(e){return e.id===+a});return r?(r.selected=n,r.selected&&(t.goToCenter={lat:+r.lat,lng:+r.lng}),t):t})}},{key:"handleCurrentLocation",value:function(){this.setState({goToCenter:this.props.store.position})}},{key:"handleNavigation",value:function(e,t){this.setState({navigationValue:t})}},{key:"handleChangeState",value:function(){var e=this,t=this.state,a=t.data,n=t.navigationValue,r=a.filter(function(e){return e.selected&&e.estado===n});if(!r.length)return alert("Seleccione al menos un registro");var o=r.map(function(e){return e.id});return this.setState({loading:!0}),0===n?D.OrdersOnRoute(o).then(this.__updateRecords).catch(function(t){return e.setState({error:t,loading:!1})}):1===n?D.OrdersDelivered(o).then(this.__updateRecords).catch(function(t){return e.setState({error:t,loading:!1})}):(this.setState({loading:!1}),void alert("No se encontro el navigationValue="+n))}},{key:"__updateRecords",value:function(e,t){this.setState(function(a){var n=Object(E.a)({},a,{loading:!1});return n.data=a.data,e.forEach(function(e){var a=n.data.find(function(t){return t.id===e.id});if(a)return n.data[n.data.indexOf(a)]=Object(E.a)({},a,{selected:!1},e);!a&&t&&n.data.push(e)}),n})}},{key:"render",value:function(){var e=this,t=this.state,a=t.now,n=t.loading,o=t.error,i=t.data,l=t.goToCenter,c=t.navigationValue;if(n)return r.a.createElement("div",{style:{width:"100%",textAlign:"center",margin:"auto",paddingTop:100}},r.a.createElement(g.i,{size:70}),r.a.createElement(g.L,{variant:"h4"},"CARGANDO..."));if(o)return r.a.createElement("div",{style:{width:"100%",textAlign:"center",margin:"auto",paddingTop:100}},r.a.createElement(f.n,{size:70}),r.a.createElement(g.L,{variant:"h4"},"Ocurri\xf3 un error"),r.a.createElement(g.L,{variant:"subtitle1"},o.message),r.a.createElement(g.L,{variant:"body1"},o.status," | ",o.statusText," | ",o.code));var s,d=this.props.store&&this.props.store.G_M_K||"",u=i.filter(function(e){return e.selected&&e.estado===c});return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",height:"100%"}},r.a.createElement("div",{style:{flex:1,overflow:"auto",height:"100%"}},r.a.createElement(g.I,{textColor:"primary",indicatorColor:"primary",style:{width:"100%"},color:"primary",value:c,onChange:this.handleNavigation},r.a.createElement(g.C,{style:{width:"32%"},label:"Pendientes",component:p.b,to:this.props.match.path+"/0"}),r.a.createElement(g.C,{style:{width:"32%"},label:"En Ruta",component:p.b,to:this.props.match.path+"/1"}),r.a.createElement(g.C,{style:{width:"32%"},label:"Entregado",component:p.b,to:this.props.match.path+"/2"})),r.a.createElement(m.d,null,r.a.createElement(m.b,{path:this.props.match.path+"/0",render:function(t){return r.a.createElement(_,Object.assign({onMounted:e.handleNavigation},t,{data:i,timeCol:"fecha",selections:u,onSelect:e.handleSelect,now:a,estado:0}))}}),r.a.createElement(m.b,{path:this.props.match.path+"/1",render:function(t){return r.a.createElement(_,Object.assign({onMounted:e.handleNavigation},t,{data:i,timeCol:"onRouteAt",selections:u,onSelect:e.handleSelect,estado:1}))}}),r.a.createElement(m.b,{path:this.props.match.path+"/2",render:function(t){return r.a.createElement(_,Object.assign({onMounted:e.handleNavigation},t,{data:i,timeCol:"deliveredAt",selections:u,onSelect:e.handleSelect,estado:2}))}}),r.a.createElement(m.a,{path:this.props.match.path,to:this.props.match.path+"/0"})),2===c?null:r.a.createElement("div",{style:{display:"flex",flexDirection:"row",paddingLeft:10,paddingRight:10}},r.a.createElement(g.b,{disabled:!u.length,style:{flex:1},variant:"outlined",color:"primary",onClick:this.handleChangeState},0===(s=c)?"ENVIAR":1===s?"ENTREGADO":s),r.a.createElement(g.b,{variant:"outlined",style:{marginLeft:10},color:"secondary",disabled:!u.length,target:"_blank",href:function(e,t){for(var a=[e],n=0;n<t.length;n++)a.push(t[n]);return 1===a.length?"":"https://www.google.com/maps/dir/ "+a.map(function(e){return[e.lat,e.lng].join(",")}).join("/")}(this.props.store.position,u||[]),component:"a"},"Ruta"))),r.a.createElement("div",{style:{flex:1,overflow:"auto",height:"100%",display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:1}},r.a.createElement(W,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=".concat(d||"","&v=3.exp&libraries=geometry,drawing,places"),containerElement:r.a.createElement("div",{style:{height:"100%"}}),loadingElement:r.a.createElement("div",{style:{height:"100%"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),selections:u,store:this.props.store,center:l||this.props.store.position}))))}}]),t}(r.a.Component);var W=Object(O.withScriptjs)(Object(O.withGoogleMap)(function(e){return r.a.createElement(O.GoogleMap,Object.assign({},e,{defaultCenter:e.store.position,defaultZoom:15,options:{disableDefaultUI:!0,zoomControl:!0,clickableIcons:!1}}),r.a.createElement(y.MarkerWithLabel,{labelAnchor:new window.google.maps.Point(0,0),position:e.store.position,options:{icon:"./store.png"},labelStyle:{background:"#fff",border:"1px solid #29b6f6",padding:"2px 10px"}},r.a.createElement(g.L,{variant:"body1",color:"inherit"},"Tu Tienda")),e.selections&&e.selections.map(function(e){return r.a.createElement(y.MarkerWithLabel,{key:e.id,labelAnchor:new window.google.maps.Point(0,0),position:{lat:+e.lat,lng:+e.lng},labelStyle:{background:"#fff",border:"1px solid grey",padding:"2px 10px"}},r.a.createElement(g.L,{variant:"button"},e.nombre))}))}));var H=a(78),q=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"ListenOrderChanges",value:function(){return D.ListenOnOrderChange(function(e){var t,a=Object(H.a)(e,1)[0];0===a.estado&&(t=new Notification("NUEVO PEDIDO",{body:a.nombre+" - Orden #"+a.numero,icon:"./favicon.ico"})),1===a.estado&&(t=new Notification("LA ORDEN #"+a.numero+" EST\xc1 EN RUTA",{body:a.nombre+" - Orden #"+a.numero,icon:"./favicon.ico"})),2===a.estado&&(t=new Notification("LA ORDEN #"+a.numero+" FUE ENTREGADA",{body:a.nombre+" - Orden #"+a.numero,icon:"./favicon.ico"})),3===a.estado&&(t=new Notification("LA ORDEN #"+a.numero+" FUE CANCELADA",{body:a.nombre+" - Orden #"+a.numero,icon:"./favicon.ico"}),t=null),t&&(t.onclick=function(){window.focus(),window.location.href="#/orders/"+a.estado+"/"+a.id})})}}]),e}(),K=function(e){var t=e.paused?"secondary":"primary";return r.a.createElement(g.c,{style:{display:"inline-block",width:200,margin:10,height:285},id:"ITEM-CONTAINER-"+e.id},r.a.createElement(g.d,{style:{height:220,overflow:"hidden"},value:e.id,onClick:e.onItemClick},r.a.createElement(g.g,{style:{height:140},image:e.imgSrc||"https://diegopq95.github.io/img/default.png",title:"Imagen"}),r.a.createElement(g.f,null,r.a.createElement(g.L,{variant:"subtitle2"},e.nombre),r.a.createElement(g.L,{variant:"body1",style:{whiteSpace:"pre-wrap"}},e.descripcion))),r.a.createElement(g.e,{style:{display:"flex",flexDirection:"row"}},r.a.createElement(g.r,{onClick:e.onItemAction,disabled:"pause"===e.loading,name:"pause",value:e.id,color:t,title:e.paused?"No Disponible":"Disponible"},"pause"===e.loading?r.a.createElement(g.i,{size:20,color:t}):e.paused?r.a.createElement(f.t,{fontSize:"small",color:"inherit"}):r.a.createElement(f.v,{fontSize:"small",color:"inherit"})),r.a.createElement("div",{style:{flex:1,textAlign:"right"}},"left"===e.loading||"right"===e.loading?r.a.createElement(g.i,{size:20,style:{marginRight:40}}):r.a.createElement(r.a.Fragment,null,r.a.createElement(g.r,{onClick:e.onItemAction,value:e.id,name:"left"},r.a.createElement(f.f,null)),r.a.createElement(g.r,{onClick:e.onItemAction,value:e.id,name:"right"},r.a.createElement(f.g,null))))))},Y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={menuEl:null},a.handleMenu=a.handleMenu.bind(Object(h.a)(Object(h.a)(a))),a.handleMenuClose=a.handleMenuClose.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleMenu",value:function(e){this.setState({menuEl:e.target})}},{key:"handleMenuClose",value:function(){this.setState({menuEl:null})}},{key:"render",value:function(){var e=this,t=this.props,a=t.nombre,n=t.items,o=t.id,i=t.loading,l=t.loading_action;console.info("Group "+o+" rendered");var c=this.state.menuEl;return r.a.createElement("div",{style:{width:"calc(100% - 40px)",padding:"10px 20px"},id:"GROUP-ROOT-"+o},r.a.createElement(g.a,{position:"relative",color:"default"},r.a.createElement(g.K,null,l?r.a.createElement("div",{style:{marginRight:10}},r.a.createElement(g.i,{size:20})):r.a.createElement("div",{style:{marginRight:10}},r.a.createElement(g.r,{onClick:this.props.onGroupAction,name:"up",value:o},r.a.createElement(f.h,{fontSize:"small"})),r.a.createElement(g.r,{onClick:this.props.onGroupAction,name:"down",value:o},r.a.createElement(f.e,{fontSize:"small"}))),r.a.createElement(g.L,{variant:"h6",color:"inherit",style:{flexGrow:1}},a," (",n&&n.length||0," items)"),r.a.createElement(g.r,{disabled:i,onClick:this.handleMenu},i?r.a.createElement(g.i,{size:20,color:"inherit"}):r.a.createElement(f.s,null)))),r.a.createElement("div",{style:{width:"100%",overflow:"auto",whiteSpace:"nowrap",scrollBehavior:"smooth"},id:"GROUP-CONTAINER-"+o},r.a.createElement(g.c,{style:{display:"inline-block",width:200,margin:10}},r.a.createElement(g.d,{style:{height:285,textAlign:"center"},component:"button",value:"NUEVO~"+o,onClick:this.props.onItemClick},r.a.createElement(g.f,null,r.a.createElement(f.d,{fontSize:"large"}),r.a.createElement(g.L,{variant:"h6"},"NUEVO")))),n&&n.sort(function(e,t){return e.orden-t.orden}).map(function(t){return r.a.createElement(K,Object.assign({},t,{onItemClick:e.props.onItemClick,onItemAction:e.props.onItemAction,key:t.id}))})),r.a.createElement(g.x,{anchorEl:c,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(c),onClose:this.handleMenuClose,onClick:this.handleMenuClose},r.a.createElement(g.y,{value:o,onClick:this.props.onGroupEdit},"Editar"),r.a.createElement(g.y,{value:o,onClick:this.props.onGroupDelete},"Eliminar")))}}]),t}(r.a.PureComponent),Z=a(26),$=a(44);function Q(e){return new Promise(function(t,a){var n=e&&e[0];if(!n)return a({message:"Archivo no encontrado"});if(n.type.indexOf("image")<0)return a({message:"El archivo no es una imagen"});var r=(9.5367431640625e-7*n.size).round(2);if(r>1&&a({message:"Solo se pueden subir imagenes de hasta 1mb. Umagen actual (".concat(r," MB)")}),e&&e[0]){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.onerror=a,o.readAsDataURL(n)}})}var X,ee=function(e){function t(){document.getElementById("img-src-input-hidden").click()}var a={maxHeight:e.height,maxWidth:"100%",cursor:"pointer"};return e.border&&(a.border="1px dotted #949494"),r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"file",id:"img-src-input-hidden",onChange:e.onChange,hidden:!0,accept:"image/*"}),e.loading?r.a.createElement("div",{style:{height:e.height,maxWidth:"100%",margin:"auto",display:"table"}},r.a.createElement("div",{style:{display:"table-cell",verticalAlign:"middle",height:"100%"}},r.a.createElement(g.i,{color:"primary",size:100}))):e.src?r.a.createElement("img",{onClick:t,title:"Click para cambiar la foto. O arrastra tu imagen.",src:e.src,alt:e.name,style:a}):r.a.createElement("div",{style:{height:e.height,maxWidth:"100%",margin:"auto",display:"table"}},r.a.createElement(g.b,{variant:e.border?"outlined":"text",type:"button",onClick:t,style:{display:"table-cell",verticalAlign:"middle",height:"100%"}},r.a.createElement(f.c,{fontSize:"large"}),r.a.createElement(g.L,{variant:"h6"},"Agrega una foto"))))},te=Object($.withStyles)({paper:{maxHeight:"calc(100% - 20px)"}})(function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={id:null,idGrupo:null,nombre:"",descripcion:"",pvp:"",imgSrc:"",pagaIva:!1,habilitado:!0,error:null,loading:"INITIAL"},a.handleInput=a.handleInput.bind(Object(h.a)(Object(h.a)(a))),a.handleCheck=a.handleCheck.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),a.handleClick=a.handleClick.bind(Object(h.a)(Object(h.a)(a))),a.handleDelete=a.handleDelete.bind(Object(h.a)(Object(h.a)(a))),a.handlePhotoChange=a.handlePhotoChange.bind(Object(h.a)(Object(h.a)(a))),a.handlePhotoDrop=a.handlePhotoDrop.bind(Object(h.a)(Object(h.a)(a))),a.handlePhotoOver=a.handlePhotoOver.bind(Object(h.a)(Object(h.a)(a)));var n=a.props.match.params.info;if(n.indexOf("~")>=0){var r=n.split("~"),o=Object(H.a)(r,2),i=o[0],c=o[1];a.state.id=i,a.state.idGrupo=+c}else a.state.id=n;return"NUEVO"===a.state.id&&(a.state.loading=!1),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this;"NUEVO"!==this.state.id&&D.GetProduct(this.state.id).then(function(t){e.setState(Object(E.a)({},t,{loading:!1}))}).catch(function(t){return e.setState({error:t,loading:"INITIAL-FAILED"})})}},{key:"handleInput",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(Object(Z.a)({},a,n))}},{key:"handleCheck",value:function(e){var t=e.currentTarget,a=t.name,n=t.checked;this.setState(Object(Z.a)({},a,n))}},{key:"handleClick",value:function(){var e=this;if(!this.state.loading){if(!this.state.pvp||isNaN(this.state.pvp))return alert("Digite un Precio valido");if(!this.state.nombre)return alert("Agregue el nombre");if(!this.state.idGrupo)return alert("Seleccione un grupo");if(!this.state.imgSrc)if(!window.confirm("Este item no tiene una imagen, est\xe1 seguro de continuar?"))return;this.setState({loading:!0,error:null}),D.SaveProduct(this.state).then(function(t){try{e.setState({loading:!1,error:null}),e.props.onClose(Object(E.a)({},e.state,t))}catch(a){}}).catch(function(t){return e.setState({error:t,loading:!1})})}}},{key:"handleDelete",value:function(){var e=this;this.state.loading||window.confirm("Esta seguro de eliminar este registro?")&&(this.setState({loading:!0,error:null}),D.DeleteProduct(this.state).then(function(t){e.props.onClose({id:e.state.id,delete:!0})}).catch(function(t){return e.setState({error:t,loading:!1})}))}},{key:"handleClose",value:function(e){if(this.state.loading&&e)return e.preventDefault();this.props.onClose()}},{key:"handlePhotoChange",value:function(e){var t=this;Q(e.currentTarget.files).then(function(e){return t.setState({imgSrc:e})}).catch(function(e){return alert("Ocurrio un problema al cargar tu imagen: "+e.message)})}},{key:"handlePhotoDrop",value:function(e){var t=this;e.preventDefault(),Q(e.dataTransfer.files).then(function(e){return t.setState({imgSrc:e})}).catch(function(e){return alert("Ocurrio un problema al cargar tu imagen: "+e.message)}),document.getElementById("product-dialog-container").classList.remove("with-drop-view")}},{key:"handlePhotoEnter",value:function(e){document.getElementById("product-dialog-container").classList.add("with-drop-view"),e.preventDefault()}},{key:"handlePhotoLeave",value:function(e){e.preventDefault()}},{key:"handlePhotoOver",value:function(e){e.dataTransfer.dropEffect="copy",e.preventDefault(),void 0!==this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){document.getElementById("product-dialog-container").classList.remove("with-drop-view")},200),console.info("dragenter")}},{key:"render",value:function(){var e=this,t=this.state;console.info("product dialog rendered");var a=isNaN(this.state.pvp)?0:+this.state.pvp,n=a?(a+(t.pagaIva?a*(this.props.porcentajeIVA||12)/100:0)).round(2):0;return"INITIAL"===t.loading?r.a.createElement(g.j,{open:!0},r.a.createElement(g.l,{style:{textAlign:"center",paddingTop:150,width:500,height:300}},r.a.createElement(g.i,{size:70}),r.a.createElement(g.L,{variant:"h6"},"CARGANDO..."))):"INITIAL-FAILED"===t.loading?r.a.createElement(g.j,{onClose:function(t){return e.handleClose()},open:!0},r.a.createElement(g.l,{style:{textAlign:"center",paddingTop:150,width:500,height:300}},r.a.createElement(g.L,{color:"secondary",variant:"h5"},"Hubo un error al cargar la informaci\xf3n"),r.a.createElement(g.L,{color:"secondary",variant:"h6"},t.error.message),r.a.createElement(g.L,{color:"secondary",variant:"body1"},t.error.code," ",t.error.status))):r.a.createElement(g.j,{id:"product-dialog-container",onDrop:this.handlePhotoDrop,onDragOver:this.handlePhotoOver,onDragEnter:this.handlePhotoEnter,onDragLeave:this.handlePhotoLeave,open:!0,onClose:this.handleClose,classes:{paper:this.props.classes.paper}},r.a.createElement(g.l,{style:{textAlign:"center",paddingTop:0,paddingBottom:0,overflowX:"hidden"}},r.a.createElement(g.J,{autoFocus:!0,value:t.nombre,name:"nombre",onChange:this.handleInput,label:"Nombre",variant:"standard",fullWidth:!0,style:ae.textField}),r.a.createElement(ee,{onChange:this.handlePhotoChange,src:t.imgSrc,name:t.nombre,height:"calc(100vh - 430px)"}),r.a.createElement(g.J,{value:void 0===t.descripcion||null===t.descripcion?"":t.descripcion,name:"descripcion",onChange:this.handleInput,inputProps:{rows:3},label:"Descripcion",variant:"outlined",multiline:!0,fullWidth:!0,style:ae.textField}),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(g.J,{value:t.pvp,name:"pvp",type:"number",label:"Precio sin impuestos",inputProps:{step:"0.01"},onChange:this.handleInput,style:Object(E.a)({},ae.textField,{flex:1}),InputProps:{endAdornment:r.a.createElement(g.s,{position:"end"},r.a.createElement(g.p,{control:r.a.createElement(g.h,{color:"primary",name:"pagaIva",checked:t.pagaIva,onChange:this.handleCheck}),label:"IVA"}))}}),r.a.createElement(g.L,{variant:"body2",style:{marginLeft:15,paddingTop:15,width:130,paddingLeft:5,paddingRight:5}},"PRECIO FINAL: $",n.toFixed(2))),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(g.J,{style:Object(E.a)({},ae.textField,{flex:1}),value:t.idGrupo||1,onChange:this.handleInput,name:"idGrupo",label:"Grupo",select:!0,SelectProps:{native:!0}},this.props.grupos&&this.props.grupos.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.nombre)})),r.a.createElement(g.p,{style:{marginLeft:15,marginRight:0,width:130},label:t.habilitado?"Habilitado":"Deshabilitado",control:r.a.createElement(g.B,{checked:t.habilitado,onChange:this.handleCheck,name:"habilitado"})}))),r.a.createElement(g.k,null,t.error&&r.a.createElement(g.L,{style:{width:"100%"},color:"secondary"},t.error.message),r.a.createElement(g.b,{fullWidth:!0,style:Object(E.a)({},ae.textField,{flex:1}),disabled:t.loading,variant:"outlined",type:"button",onClick:this.handleClick,color:"primary"},t.loading?r.a.createElement(g.i,{size:30,color:"primary"}):"GUARDAR"),"NUEVO"!==t.id&&!1!==t.eliminable?r.a.createElement(g.b,{disabled:t.loading,variant:"outlined",type:"button",onClick:this.handleDelete,color:"secondary"},t.loading?r.a.createElement(g.i,{size:30,color:"secondary"}):"ELIMINAR"):null))}}]),t}(r.a.PureComponent)),ae={textField:{marginTop:10,marginBottom:10}},ne=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={input:"",inputLabel:""},a.handleInput=a.handleInput.bind(Object(h.a)(Object(h.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),a.state.input=e.value||"",a.state.inputLabel=e.label||"",a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleInput",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(Object(Z.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),!this.state.loading){if(!this.state.input)return this.setState({error:"El texto no puede estar vac\xedo."});if(this.setState({loading:!0}),!this.props.onSubmit)return alert("You Must especify TextPrompt.onSubmit event");this.props.onSubmit(this.state.input,function(e){t.setState({error:e,loading:!1})})}}},{key:"handleClose",value:function(e){var t=this;if(this.state.loading)return e.preventDefault();this.props.onSubmit(void 0,function(e){t.setState({error:e,loading:!1})})}},{key:"render",value:function(){console.info("TextPrompt rendering");var e=this.state;return r.a.createElement(g.j,{maxWidth:"lg",open:!0,onClose:this.handleClose},r.a.createElement(g.l,{style:{width:300}},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(g.J,{value:e.input,name:"input",onChange:this.handleInput,label:e.inputLabel,variant:"outlined",fullWidth:!0,style:re.textField,autoFocus:!0}),e.error&&r.a.createElement(g.L,{color:"secondary",variant:"body2"},e.error),r.a.createElement(g.b,{fullWidth:!0,variant:"outlined",disabled:e.loading,type:"submit",color:"primary"},e.loading?r.a.createElement(g.i,{size:30,color:"primary"}):"GUARDAR"))))}}]),t}(r.a.PureComponent),re={textField:{marginTop:10,marginBottom:10}},oe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={grupos:[],loading:!0,currentGroup:null},e.onMounted&&e.onMounted(e.stepID),a.deleteGroup=a.deleteGroup.bind(Object(h.a)(Object(h.a)(a))),a.editGroup=a.editGroup.bind(Object(h.a)(Object(h.a)(a))),a.editGroupEnding=a.editGroupEnding.bind(Object(h.a)(Object(h.a)(a))),a.updateGrupo=a.updateGrupo.bind(Object(h.a)(Object(h.a)(a))),a.handleGroupAction=a.handleGroupAction.bind(Object(h.a)(Object(h.a)(a))),a.handleItemClick=a.handleItemClick.bind(Object(h.a)(Object(h.a)(a))),a.handleItemAction=a.handleItemAction.bind(Object(h.a)(Object(h.a)(a))),a.editItemEnd=a.editItemEnd.bind(Object(h.a)(Object(h.a)(a))),a.updateProduct=a.updateProduct.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;D.GetGroups().then(function(t){var a=t.sort(function(e,t){return e.orden-t.orden}).map(function(e){return e.items||(e.items=[]),e.items=e.items.sort(function(e,t){return e.orden-t.orden}),e});e.setState({grupos:a,loading:!1})}).catch(function(t){e.setState({loading:!1,error:t})})}},{key:"handleItemAction",value:function(e){var t=this,a=+e.currentTarget.value,n=e.currentTarget.name;this.updateProduct("loading",{id:a,loading:n}),D.RequestActionProduct({id:a,action:n}).then(function(e){for(var a=0;a<e.length;a++){var n=e[a];t.updateProduct(null,Object(E.a)({},n,{loading:null}))}}).catch(function(e){alert(e.message),t.updateProduct("loading",{id:a,loading:null})})}},{key:"handleItemClick",value:function(e){var t=e.currentTarget.value;t.indexOf("NUEVO")>=0&&this.updateProduct("loading",{id:+t,loading:!0}),this.props.history.push(this.props.match.path+"/"+t)}},{key:"editItemEnd",value:function(e){e&&this.updateProduct(null,e),this.props.history.push(this.props.match.path)}},{key:"updateProduct",value:function(e,t){var a=this;this.setState(function(n){t.idGrupo=+t.idGrupo;var r=Object(E.a)({},n);r.grupos=n.grupos;var o,i=r.grupos.find(function(e){return e.items&&e.items.find(function(e){return e.id===t.id})});if(t.delete){if(i){var l=i.items.indexOf(i.items.find(function(e){return e.id===t.id}));i.items.splice(l,1),i.items=Object(N.a)(i.items).sort(function(e,t){return e.orden-t.orden})}return r}if(i){var c=i.items.find(function(e){return e.id===t.id}),s=i.items.indexOf(c);if(t.idGrupo&&t.idGrupo!==i.id)i.items.splice(s,1),i.items=Object(N.a)(i.items).sort(function(e,t){return e.orden-t.orden}),(o=r.grupos.find(function(e){return e.id===t.idGrupo}))&&(o.items.push(t),a.scrollGroupToItem(o.id,t.id));else if(o=i,e)c[e]=t[e];else{var d=Object(E.a)({},c);for(var u in t)t.hasOwnProperty(u)&&(d[u]=t[u]);i.items[s]=d}}else(o=r.grupos.find(function(e){return e.id===t.idGrupo}))&&(o.items.push(t),a.scrollGroupToItem(o.id,t.id));return o&&(o.items=Object(N.a)(o.items).sort(function(e,t){return e.orden-t.orden})),r})}},{key:"deleteGroup",value:function(e){var t=this,a=+e.currentTarget.value;a&&(window.confirm("Esta seguro de borrar este registro?")&&(this.updateGrupo("loading",{id:a,loading:!0}),D.DeleteGroup({id:a}).then(function(e){t.setState(function(e){var t=Object(E.a)({},e);t.grupos=e.grupos;var n=t.grupos.find(function(e){return e.id===a});return n&&t.grupos.splice(t.grupos.indexOf(n),1),t.grupos})}).catch(function(e){alert(e.message),t.updateGrupo("loading",{id:a,loading:!1})})))}},{key:"editGroup",value:function(e){var t=e.currentTarget.value;if("NUEVO"===t)return this.setState({currentGroup:{}});var a=this.state.grupos.find(function(e){return e.id===+t});this.setState({currentGroup:{id:a.id,value:a.nombre}})}},{key:"handleGroupAction",value:function(e){var t=this,a=+e.currentTarget.value,n=e.currentTarget.name;this.updateGrupo("loading_action",{id:a,loading_action:!0}),D.RequestActionGroup({id:a,action:n}).then(function(e){e.forEach(function(e){t.updateGrupo(null,Object(E.a)({},e,{loading_action:null}))}),t.scrollToGroupId(a)}).catch(function(e){t.updateGrupo("loading_action",{id:a,loading_action:null}),alert(e.message)})}},{key:"editGroupEnding",value:function(e,t){if(!e)return this.setState({currentGroup:null});var a=this.state.currentGroup;return a.value===e?this.setState({currentGroup:null}):this.state.grupos.find(function(t){return t.id!==a.id&&t.nombre.toUpperCase()===e.toUpperCase()})?t("Este nombre ya existe"):void D.SaveGroup({id:a.id,nombre:e}).then(this.updateGrupo.bind(this,"nombre")).catch(function(e){return t(e.message)})}},{key:"scrollToGroupId",value:function(e,t){setTimeout(function(){window.requestAnimationFrame(function(){var a=document.getElementById("product-div"),n=document.getElementById("GROUP-ROOT-"+e);if(n){var r=n.offsetTop-70;a.scrollTop=r,t&&t()}})})}},{key:"scrollGroupToItem",value:function(e,t){this.scrollToGroupId(e,function(){setTimeout(function(){window.requestAnimationFrame(function(){var a=document.getElementById("GROUP-CONTAINER-"+e),n=document.getElementById("ITEM-CONTAINER-"+t);n&&(a.scrollLeft=n.offsetLeft)})},300)})}},{key:"updateGrupo",value:function(e,t){var a=this;this.setState(function(n){var r=Object(E.a)({},n);r.grupos=n.grupos;var o=r.grupos.find(function(e){return e.id===t.id});o?e?e.split(",").forEach(function(e){o[e]=t[e]}):(t.items=o.items,r.grupos[r.grupos.indexOf(o)]=Object(E.a)({},o,t)):(r.grupos.push(t),a.scrollToGroupId(t.id));return r.currentGroup=null,r})}},{key:"render",value:function(){var e=this;console.info("Product view rendered");var t=this.state,a=t.grupos,n=t.loading,o=t.error,i=t.currentGroup;return n?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(g.i,{size:100}),r.a.createElement(g.L,{variant:"h4"},"CARGANDO...")):o?r.a.createElement("div",{style:{textAlign:"center",paddingTop:200}},r.a.createElement(g.L,{variant:"subtitle1"}," Ocurrio un error"),r.a.createElement(g.L,{variant:"body1"},o.message),r.a.createElement(g.L,{variant:"caption"},o.code," ",o.status)):r.a.createElement("div",{style:{height:"100%",overflow:"auto",scrollBehavior:"smooth"},id:"product-div"},r.a.createElement("div",{style:{width:"calc(100% - 40px)",padding:20}},r.a.createElement(g.a,{position:"relative",color:"default"},r.a.createElement(g.d,{onClick:this.editGroup,value:"NUEVO"},r.a.createElement(g.K,null,r.a.createElement(f.d,{style:{marginRight:10}}),r.a.createElement(g.L,{variant:"h6",color:"inherit",style:{flexGrow:1}},"NUEVO GRUPO"))))),a&&a.length?a.sort(function(e,t){return e.orden-t.orden}).map(function(t){return r.a.createElement(Y,Object.assign({onGroupAction:e.handleGroupAction,onGroupEdit:e.editGroup,onGroupDelete:e.deleteGroup,onItemAction:e.handleItemAction,onItemClick:e.handleItemClick,key:t.id},t))}):null,r.a.createElement(m.b,{path:this.props.match.path+"/:info",render:function(t){return r.a.createElement(te,Object.assign({porcentajeIVA:12,grupos:a.map(function(e){return{id:e.id,nombre:e.nombre}}),onClose:e.editItemEnd},t))}}),i&&r.a.createElement(ne,Object.assign({label:"Nombre del Grupo"},i,{onSubmit:this.editGroupEnding})))}}]),t}(r.a.Component);function ie(e){var t=e.feedback[e.name],a=t&&"loading"!==t,n={InputProps:t&&("loading"===t?{endAdornment:r.a.createElement(g.s,null,r.a.createElement(g.i,{title:"Guardando...",color:"primary",size:20}))}:{endAdornment:r.a.createElement(g.s,null,r.a.createElement(f.w,{color:"secondary"}))})};return a&&(n.helperText=r.a.createElement(g.L,{variant:"caption",color:"secondary"},t)),r.a.createElement(g.J,Object.assign({type:e.type,style:{marginTop:10,marginBottom:10},fullWidth:!0,onChange:function(t){var a=t.currentTarget,n=a.type,r=a.value;e.onChange(t);var o=!0;"number"===n&&(o=null!==r&&void 0!==r&&r.toString().length&&!isNaN(+r)),X&&clearTimeout(X),e.onUpdate&&o&&(X=setTimeout(function(){e.onUpdate(e.name,"number"===n?parseFloat(r):r)},1500))},value:e.value,label:e.label,name:e.name,multiline:e.multiline,inputProps:e.inputProps},n,{color:a?"secondary":"primary"}))}var le=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={feedback:{}},a.timeouts={},e.onMounted&&e.onMounted(e.stepID),a.handleInput=a.handleInput.bind(Object(h.a)(Object(h.a)(a))),a.handleUpdateProp=a.handleUpdateProp.bind(Object(h.a)(Object(h.a)(a))),a.handleLogo=a.handleLogo.bind(Object(h.a)(Object(h.a)(a)));var n=e.configuracion;if(n)for(var r in n)n.hasOwnProperty(r)&&(a.state[r]=n[r]);return a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleInput",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;"loading"!==this.state.feedback[a]&&this.setState(Object(Z.a)({},a,n))}},{key:"handleUpdateProp",value:function(e,t,a){var n=this;if("loading"!==this.state.feedback[e]){this.setState(function(t){var a=Object(E.a)({},t);return a.feedback=Object(E.a)({},a.feedback,Object(Z.a)({},e,"loading")),a});var r=D.setConfigInfo(Object(Z.a)({},e,t||this.state[e])).then(function(t){return n.setState(function(t){var a=Object(E.a)({},t);return a.feedback=Object(E.a)({},a.feedback,Object(Z.a)({},e,"loading")),delete a.feedback[e],a})});if(a)return r;r.catch(function(t){return n.setState(function(a){var n=Object(E.a)({},a);return n.feedback=Object(E.a)({},n.feedback,Object(Z.a)({},e,t.message)),n})})}}},{key:"handleLogo",value:function(e){var t=this;"loading"!==this.state.feedback.logoSrc&&Q(e.currentTarget.files).then(function(e){return t.handleUpdateProp("logoSrc",e,!0).then(function(a){return t.setState({logoSrc:e})})}).catch(function(e){alert("Ocurrio un problema al cargar tu imagen: "+e.message),t.setState(function(e){var t=Object(E.a)({},e);return t.feedback=Object(E.a)({},t.feedback),delete t.feedback.logoSrc,t})})}},{key:"render",value:function(){var e=this.state,t=e.titulo,a=e.slogan,n=e.logoSrc,o=e.direccion,i=e.telefono,l=e.whatsAppMessage,c=e.whatsAppPhone,s=e.feedback;return r.a.createElement("div",null,r.a.createElement(g.q,{container:!0},r.a.createElement(g.q,{item:!0,xs:6,style:{padding:10}},r.a.createElement(ie,{label:"Nombre de la Tienda",onUpdate:this.handleUpdateProp,value:t||"",name:"titulo",onChange:this.handleInput,feedback:s,inputProps:{maxLength:100}}),r.a.createElement("div",{style:{textAlign:"center",padding:10}},r.a.createElement(ee,{loading:s.logoSrc,onChange:this.handleLogo,src:n,border:!0,name:"Logo de la Tienda",height:"calc(100vh - 400px)"})),r.a.createElement(ie,{label:"Slogan de la Tienda",onUpdate:this.handleUpdateProp,value:a||"",name:"slogan",onChange:this.handleInput,feedback:s,inputProps:{maxLength:100}})),r.a.createElement(g.q,{item:!0,xs:6,style:{padding:10}},r.a.createElement(ie,{label:"Direccion de la Tienda",onUpdate:this.handleUpdateProp,value:o||"",name:"direccion",onChange:this.handleInput,feedback:s,multiline:!0,inputProps:{rows:2,maxLength:300}}),r.a.createElement(ie,{label:"Telefono",onUpdate:this.handleUpdateProp,value:i||"",name:"telefono",onChange:this.handleInput,feedback:s,type:"phone",inputProps:{maxLength:50}}),r.a.createElement(ie,{label:"Numero en Whatsapp",onUpdate:this.handleUpdateProp,value:c||"",name:"whatsAppPhone",onChange:this.handleInput,feedback:s,type:"phone",inputProps:{maxLength:20}}),r.a.createElement(ie,{label:"Escribe el mensaje de Whatsapp que quieres recibir cuando seas contactado",onUpdate:this.handleUpdateProp,value:l||"",name:"whatsAppMessage",onChange:this.handleInput,feedback:s,multiline:!0,inputProps:{rows:3,maxLength:300}}))))}}]),t}(r.a.PureComponent),ce=function(){function e(){Object(l.a)(this,e)}return Object(c.a)(e,null,[{key:"currentPosition",value:function(){return new Promise(function(e,t){if(console.info("obteniendo posicion actual con navigator.geolocation.getCurrentPosition"),!navigator.geolocation)return console.info("navigator.geolocation.getCurrentPosition no existe en este navegador, intentando con PositionByIP()"),se().then(e).catch(t);navigator.geolocation.getCurrentPosition(function(t){return e({lat:t.coords.latitude,lng:t.coords.longitude})},function(){console.info("navigator.geolocation.getCurrentPosition fall\xf3, intentando con PositionByIP()"),se().then(e).catch(t)})})}}]),e}();function se(){return fetch("https://ipapi.co/json/").then(function(e){return e.json()}).then(function(e){return{lat:e.latitude,lng:e.longitude}})}ce.QUITO_BOUNDS={west:-78.853,north:-.04875,east:-78.17184,south:-.39207},ce.QUITO={lat:-.189515,lng:-78.488167};var de=a(95),ue=a(356),he=a.n(ue),pe=function(e){var t=e.API_KEY,a=Object(de.a)(e,["API_KEY"]);return r.a.createElement(me,Object.assign({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=".concat(t||"","&v=3.exp&libraries=geometry,drawing,places"),containerElement:r.a.createElement("div",{style:{height:"100%"}}),loadingElement:r.a.createElement("div",{style:{height:"100%"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),defaultZoom:15},a))},me=Object(O.withScriptjs)(Object(O.withGoogleMap)(function(e){var t=window.google,a=e.marker,n=e.polygons,o=e.enableDrawingManager,i=e.onPolygonComplete,l=e.onMapMounted,c=e.onPolygonClick,s=e.onPolygonMouseUp,d=Object(de.a)(e,["marker","polygons","enableDrawingManager","onPolygonComplete","onMapMounted","onPolygonClick","onPolygonMouseUp"]);return r.a.createElement(O.GoogleMap,Object.assign({},d,{options:{disableDefaultUI:!0,zoomControl:!0,clickableIcons:!1},ref:l}),a&&r.a.createElement(y.MarkerWithLabel,{labelAnchor:new t.maps.Point(0,0),position:a.position},r.a.createElement(g.c,{elevation:3,color:"secondary",style:{margin:5}},r.a.createElement(g.f,{style:{maxWidth:200,padding:5}},r.a.createElement(g.L,{variant:"button"},a.label)))),o&&r.a.createElement(he.a,{onPolygonComplete:i,defaultDrawingMode:t.maps.drawing.OverlayType.POLYGON,defaultOptions:{drawingControl:!0,drawingControlOptions:{position:t.maps.ControlPosition.TOP_CENTER,drawingModes:["polygon"]}},polygonOptions:{strokeColor:"#007bff",strokeOpacity:.8,strokeWeight:2,fillColor:"#007bff",fillOpacity:.35}}),n&&n.map(function(e,t){return r.a.createElement(O.Polygon,{key:t,path:e.path,editable:e.editable,onClick:c,onMouseUp:function(e){s&&s(this,e,t)},options:{strokeColor:"#007bff",strokeOpacity:.8,strokeWeight:2,fillColor:"#007bff",fillOpacity:.35}})}))})),ge=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={position:null,baseTransporte:0,kmBaseTransporte:0,recargoPorKm:0,google_maps_key:"",cobrarTransporte:!1,coberturas:[],editMode:0,loading:!0,defaultCenter:null,feedback:{}},a.handleTabContext=function(e){e.preventDefault(),a.setState({tabContextEl:e.currentTarget})},a.handleTabContextClose=function(){a.setState({tabContextEl:null})},a.handleDeleteAllCoberturas=function(){a.handleUpdateProp("coberturas",[],!0).then(function(){a.setState({coberturas:[]})}).catch(function(e){return a.updateFeedback("coberturas",e.message)}),a.setState({tabContextEl:null})},e.onMounted&&e.onMounted(e.stepID),a.handleInput=a.handleInput.bind(Object(h.a)(Object(h.a)(a))),a.handleUpdateProp=a.handleUpdateProp.bind(Object(h.a)(Object(h.a)(a))),a.handleCheck=a.handleCheck.bind(Object(h.a)(Object(h.a)(a))),a.handleMapMounted=a.handleMapMounted.bind(Object(h.a)(Object(h.a)(a))),a.handleNewPolygon=a.handleNewPolygon.bind(Object(h.a)(Object(h.a)(a))),a.handlePolygonMouseUp=a.handlePolygonMouseUp.bind(Object(h.a)(Object(h.a)(a))),a.handleEditMode=a.handleEditMode.bind(Object(h.a)(Object(h.a)(a))),a.handleMapClick=a.handleMapClick.bind(Object(h.a)(Object(h.a)(a)));var n=e.configuracion;if(n)for(var r in a.state)n.hasOwnProperty(r)&&(a.state[r]=n[r]);return a.state.position&&(a.state.defaultCenter=a.state.position),a.state.defaultCenter&&(a.state.loading=null,a.state.editMode=1),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleUpdateProp",value:function(e,t,a){var n=this;if("loading"!==this.state.feedback[e]){this.updateFeedback(e,"loading");var r=D.setConfigInfo(Object(Z.a)({},e,void 0===t?this.state[e]:t)).then(function(){return n.updateFeedback(e,null)});return a?r:r.catch(function(t){return n.updateFeedback(e,t.message)})}}},{key:"updateFeedback",value:function(e,t){this.setState(function(a){var n=Object(E.a)({},a);return n.feedback=Object(E.a)({},n.feedback,Object(Z.a)({},e,t)),n})}},{key:"componentDidMount",value:function(){var e=this;this.state.defaultCenter||ce.currentPosition().then(function(t){return e.setState({defaultCenter:t,loading:null})}).catch(function(t){return e.setState({error:t,loading:"ERROR"})})}},{key:"handleInput",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(Object(Z.a)({},a,n))}},{key:"handleCheck",value:function(e){var t=this;e.preventDefault();var a=e.currentTarget,n=a.name,r=a.checked,o=this.handleUpdateProp(n,r,!0);o&&o.then(function(e){t.setState(Object(Z.a)({},n,r))}).catch(function(e){alert(e.message),t.updateFeedback(n,null)})}},{key:"handleNewPolygon",value:function(e){for(var t=this,a=[],n=e.getPath(),r=0;r<n.getLength();r++)a.push(n.getAt(r).toJSON());var o=[].concat(Object(N.a)(this.state.coberturas),[{path:a}]),i=this.handleUpdateProp("coberturas",o,!0);i&&i.then(function(){t.setState({coberturas:o}),e.setMap(null)}).catch(function(a){t.updateFeedback("coberturas",a.message),e.setMap(null)})}},{key:"handleMapClick",value:function(e){var t=this,a=e.latLng.toJSON();if(0===this.state.editMode){var n=this.handleUpdateProp("position",a,!0);n&&(n.then(function(){return t.setState({position:a})}).catch(function(e){return t.updateFeedback("position",e.message)}),this.setState({position:a}))}}},{key:"handlePolygonMouseUp",value:function(e,t,a){var n=this;if(1===this.state.editMode){for(var r=[],o=e.getPath(),i=0;i<o.getLength();i++)r.push(o.getAt(i).toJSON());var l=JSON.parse(JSON.stringify(this.state.coberturas)),c=!1,s=l[a];if(s)for(var d=0;d<r.length;d++){var u=r[d],h=s.path[d];if(!h){c=!0;break}if(h.lat!==u.lat||h.lng!==u.lng){c=!0;break}}else c=!0;if(c){l[a]={path:r};var p=this.handleUpdateProp("coberturas",l,!0);p&&(this.LAST_COBERTURAS||(this.LAST_COBERTURAS=JSON.parse(JSON.stringify(this.state.coberturas))),p.then(function(){n.LAST_COBERTURAS=l}).catch(function(e){n.updateFeedback("coberturas",e.message),n.setState({coberturas:[]},function(){return n.setState({coberturas:n.LAST_COBERTURAS})})}))}}}},{key:"handleMapMounted",value:function(e){this.mapRef=e,this._fitBoundsToPolygon()}},{key:"handleEditMode",value:function(e,t){this.setState({editMode:t})}},{key:"_fitBoundsToPolygon",value:function(){if(this.mapRef&&this.state.coberturas.length){for(var e=new window.google.maps.LatLngBounds,t=0;t<this.state.coberturas.length;t++){this.state.coberturas[t].path.forEach(function(t){return e.extend(t)})}var a=this.mapRef.getBounds();a&&e.union(a),this.mapRef.fitBounds(e)}}},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.error,n=e.editMode,o=e.baseTransporte,i=e.kmBaseTransporte,l=e.recargoPorKm,c=e.feedback,s=e.cobrarTransporte,d=e.defaultCenter,u=e.position,h=e.google_maps_key,p=e.coberturas,m=e.tabContextEl,b=p&&p.length,v={defaultCenter:d,API_KEY:h,enableDrawingManager:!b&&1===n};return u&&(v.marker={position:u,label:"Tu Tienda"}),p&&p.length&&(v.polygons=p.map(function(e){return Object(E.a)({},e,{editable:1===n})})),"ERROR"===t?r.a.createElement("div",{style:{width:"100%",paddingTop:100,textAlign:"center"}},r.a.createElement(g.i,{size:100}),r.a.createElement(g.L,{variant:"h4"},"Ocurri\xf3 un error"),r.a.createElement(g.L,{variant:"subtitle1"},a.message),r.a.createElement(g.L,{variant:"body1"},a.code," ",a.status)):t?r.a.createElement("div",{style:{width:"100%",paddingTop:100,textAlign:"center"}},r.a.createElement(g.i,{size:100}),r.a.createElement(g.L,{variant:"h4"},"CARGANDO EL MAPA...")):r.a.createElement("div",{style:{display:"flex",flexDirection:"row",height:"calc(100% - 100px)"}},r.a.createElement(g.x,{anchorEl:m,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(m),onClose:this.handleTabContextClose},r.a.createElement(g.y,{onClick:this.handleDeleteAllCoberturas},"Borrar areas")),r.a.createElement("div",{style:{flex:1,padding:10}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(g.L,{style:{marginLeft:10,flex:1,paddingTop:5},variant:"h6"},"Ubicaci\xf3n de la Tienda"),r.a.createElement(g.I,{onChange:this.handleEditMode,value:n},r.a.createElement(g.C,{title:c.position,label:(u?"Cambiar":"Agregar")+" Ubicaci\xf3n",icon:c.position&&("loading"===c.position?r.a.createElement(g.i,{size:20,color:"primary"}):r.a.createElement(f.w,{color:"secondary"}))||r.a.createElement(f.q,null)}),r.a.createElement(g.C,{title:c.coberturas,label:(b?"Cambiar":"Agregar")+" Cobertura",icon:c.coberturas&&("loading"===c.coberturas?r.a.createElement(g.i,{size:20,color:"primary"}):r.a.createElement(f.w,{color:"secondary"}))||r.a.createElement(f.p,null),disabled:!u,onContextMenu:this.handleTabContext}))),d&&r.a.createElement(pe,Object.assign({onMapMounted:this.handleMapMounted,onClick:this.handleMapClick,defaultZoom:12,onPolygonComplete:this.handleNewPolygon,onPolygonClick:this.handleMapClick,onPolygonMouseUp:this.handlePolygonMouseUp},v))),r.a.createElement("div",{style:{width:300,padding:10,textAlign:"center"}},r.a.createElement(g.L,{style:{margin:10},variant:"h6"},"Tarifa de Transporte"),r.a.createElement(g.p,{label:"Cobrar Servicio de Transporte",control:c.cobrarTransporte?r.a.createElement(g.i,{size:20,color:"primary",style:{margin:12}}):r.a.createElement(g.h,{checked:s,onChange:this.handleCheck,name:"cobrarTransporte"})}),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{value:o,onChange:this.handleInput,onUpdate:this.handleUpdateProp,label:"Tarifa base",name:"baseTransporte",type:"number",feedback:c,inputProps:{step:"0.01"}}),r.a.createElement(ie,{value:i,onChange:this.handleInput,onUpdate:this.handleUpdateProp,label:"Kms que cubre la tarifa base",name:"kmBaseTransporte",type:"number",feedback:c,inputProps:{step:"0.01"}}),r.a.createElement(ie,{value:l,onChange:this.handleInput,onUpdate:this.handleUpdateProp,label:"Recargo por km adicional",name:"recargoPorKm",type:"number",feedback:c,inputProps:{step:"0.01"}}))))}}]),t}(r.a.PureComponent),fe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={dias:[],desde:[0,0],hasta:[0,0]},a.handleChange=a.handleChange.bind(Object(h.a)(Object(h.a)(a))),a.handleDays=a.handleDays.bind(Object(h.a)(Object(h.a)(a))),a.handleClick=a.handleClick.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),e.data&&"NUEVO"!==e.data&&(a.state=Object(E.a)({},e.data)),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){var t=e.currentTarget,a=t.value,n=t.name;if(n.indexOf(".")>=0){var r=n.split(".");this.setState(function(e){var t=JSON.parse(JSON.stringify(e));return t[r[0]][r[1]]=a,t})}else this.setState(Object(Z.a)({},n,a))}},{key:"handleDays",value:function(e){var t=e.currentTarget.value;this.setState(function(e){var a=JSON.parse(JSON.stringify(e));a.dias=Object(N.a)(a.dias);var n=a.dias.indexOf(+t);return n>=0?a.dias.splice(n,1):a.dias.push(+t),a})}},{key:"handleClick",value:function(){var e=this,t=this.state,a=t.loading,n=t.dias,r=t.desde,o=t.hasta;if(!a){if(!n.length)return alert("Selecciona al menos un dia");if(r[0]===o[0]&&r[1]===o[1])return alert("Las horas de inicio y fin no pueden ser iguales");this.setState({loading:!0}),this.props.guardar(this.state).catch(function(t){alert(t.message),e.setState({loading:!1})})}}},{key:"handleClose",value:function(){this.state.loading||this.props.onClose&&this.props.onClose()}},{key:"render",value:function(){var e=this.state,t=e.desde,a=e.hasta,n=e.dias,o=e.loading;return r.a.createElement(g.j,{open:!0,onClose:this.handleClose,maxWidth:"lg"},r.a.createElement(g.m,null,"HORARIO"),r.a.createElement(g.l,null,r.a.createElement("div",{style:{display:"table"}},r.a.createElement("div",{style:{display:"table-cell",width:150}},r.a.createElement(g.L,{variant:"subtitle1"},"INICIO"),r.a.createElement("div",null,r.a.createElement(be,{label:"Horas",length:23,name:"desde.0",value:t[0],onChange:this.handleChange}),r.a.createElement(g.L,{style:{display:"inline",width:"auto",marginLeft:5,marginRight:5},variant:"subtitle1"},":"),r.a.createElement(be,{label:"Minutos",items:[0,15,30,45],name:"desde.1",value:t[1],onChange:this.handleChange}))),r.a.createElement("div",{style:{display:"table-cell",width:150}},r.a.createElement(g.L,{variant:"subtitle1"},"FIN"),r.a.createElement("div",null,r.a.createElement(be,{label:"Horas",length:23,name:"hasta.0",value:a[0],onChange:this.handleChange}),r.a.createElement(g.L,{style:{display:"inline",width:"auto",marginLeft:5,marginRight:5},variant:"subtitle1"},":"),r.a.createElement(be,{label:"Minutos",items:[0,15,30,45],name:"hasta.1",value:a[1],onChange:this.handleChange}))),r.a.createElement("div",{style:{display:"table-cell"}},r.a.createElement(g.L,{variant:"subtitle1"},"SELECCIONA LOS DIAS"),r.a.createElement(ve,{value:n,onChange:this.handleDays}))),r.a.createElement(g.k,null,r.a.createElement(g.b,{disabled:o,style:{flex:1},color:"primary",variant:"outlined",onClick:this.handleClick},"GUARDAR"))))}}]),t}(r.a.PureComponent);function be(e){var t=e.length,a=e.items,n=Object(de.a)(e,["length","items"]),o=[];if(a)o=a.map(function(e){return{value:e,label:1===e.toString().length?"0".concat(e):e}});else for(var i=0;i<=t;i++)o.push({value:i,label:1===i.toString().length?"0".concat(i):i});return r.a.createElement(g.A,Object.assign({native:!0},n),o.map(function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)}))}function ve(e){var t=e.value||[];return r.a.createElement("div",{style:e.style},r.a.createElement(g.p,{label:"Lun",control:r.a.createElement(g.h,{value:"1",checked:t.indexOf(1)>=0,onChange:e.onChange})}),r.a.createElement(g.p,{label:"Mar",control:r.a.createElement(g.h,{value:"2",checked:t.indexOf(2)>=0,onChange:e.onChange})}),r.a.createElement(g.p,{label:"Mie",control:r.a.createElement(g.h,{value:"3",checked:t.indexOf(3)>=0,onChange:e.onChange})}),r.a.createElement(g.p,{label:"Jue",control:r.a.createElement(g.h,{value:"4",checked:t.indexOf(4)>=0,onChange:e.onChange})}),r.a.createElement(g.p,{label:"Vie",control:r.a.createElement(g.h,{value:"5",checked:t.indexOf(5)>=0,onChange:e.onChange})}),r.a.createElement(g.p,{label:"Sab",control:r.a.createElement(g.h,{value:"6",checked:t.indexOf(6)>=0,onChange:e.onChange})}),r.a.createElement(g.p,{label:"Dom",control:r.a.createElement(g.h,{value:"0",checked:t.indexOf(0)>=0,onChange:e.onChange})}))}var Ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={horarios:[],selected:null},e.configuracion&&e.configuracion.horarios&&(a.state.horarios=Object(N.a)(e.configuracion.horarios)),a.handleDelete=a.handleDelete.bind(Object(h.a)(Object(h.a)(a))),a.handleClose=a.handleClose.bind(Object(h.a)(Object(h.a)(a))),a.handleEdit=a.handleEdit.bind(Object(h.a)(Object(h.a)(a))),a.guardar=a.guardar.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleDelete",value:function(e){var t=this,a=e.currentTarget.value;if(this.state.horarios.length<=1)return alert("No se puede borrar: Debe existir al menos un horario");var n=this.state.horarios[+a];if(n&&!n.loading){this.setState(function(e){var t=Object(E.a)({},e);return t.horarios=Object(N.a)(t.horarios),t.horarios[a].loading=!0,t});var r=Object(N.a)(this.state.horarios);r.splice(a,1),D.setConfigInfo({horarios:r}).then(function(){t.setState({horarios:r})}).catch(function(e){alert("Ocurrio un error: "+e.message),t.setState(function(e){var t=Object(E.a)({},e);return t.horarios=Object(N.a)(t.horarios),t.horarios[a].loading=!1,t})})}}},{key:"guardar",value:function(e){var t,a=this,n=JSON.parse(JSON.stringify(this.state.horarios));return e.id&&(t=n.find(function(t){return t.id===e.id})),t?n[n.indexOf(t)]=e:n.push(e),D.setConfigInfo({horarios:n}).then(function(e){a.setState({horarios:n,selected:null})})}},{key:"handleEdit",value:function(e){var t=e.currentTarget.value;if("NUEVO"===t)return this.setState({selected:"NUEVO"});this.setState(function(e){var a=Object(E.a)({},e);a.horarios=Object(N.a)(a.horarios);var n=a.horarios[+t];return n?(a.selected=n,a):a})}},{key:"handleClose",value:function(){this.setState({selected:null})}},{key:"render",value:function(){var e=this,t=this.state,a=t.horarios,n=t.selected;return r.a.createElement("div",null,n&&r.a.createElement(fe,{data:n,onClose:this.handleClose,guardar:this.guardar}),r.a.createElement(g.D,null,r.a.createElement(g.G,null,r.a.createElement(g.H,null,r.a.createElement(g.F,{style:{width:40}}),r.a.createElement(g.F,{component:"th"},"HORA"),r.a.createElement(g.F,{component:"th"},"DIAS"),r.a.createElement(g.F,{component:"th",style:{width:40}},r.a.createElement(g.r,{onClick:this.handleEdit,value:"NUEVO"},r.a.createElement(f.b,{color:"primary"}))))),r.a.createElement(g.E,null,a&&a.map(function(t,a){return r.a.createElement(g.H,{key:a},r.a.createElement(g.F,{scope:"row",component:"th"},r.a.createElement(g.r,{disabled:t.loading,value:a,onClick:e.handleDelete},t.loading?r.a.createElement(g.i,{size:20,color:"secondary"}):r.a.createElement(f.l,null))),r.a.createElement(g.F,null,ye(t.desde,t.tz)+" - "+ye(t.hasta,t.tz)),r.a.createElement(g.F,null,t.dias.map(Oe).join(", ")),r.a.createElement(g.F,null,r.a.createElement(g.r,{disabled:t.loading,value:a,onClick:e.handleEdit},r.a.createElement(f.m,null))))}))))}}]),t}(r.a.PureComponent);function Oe(e){return 1===e?"Lun":2===e?"Mar":3===e?"Mie":4===e?"Jue":5===e?"Vie":6===e?"Sab":0===e?"Dom":"UNDEFINED"}function ye(e,t){var a=Object(H.a)(e,2),n=a[0],r=a[1];return(1===n.toString().length?"0":" ")+n+":"+(1===r.toString().length?"0":" ")+r}var Ce=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={currentTab:0,defaultConfiguracion:null,loading:!0,error:null,LoadedTabs:{}},e.onMounted&&e.onMounted(e.stepID),a.handleTabChange=a.handleTabChange.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this;D.GetConfigInfo().then(function(t){e.setState(function(e){var a=Object(E.a)({},e);return a.configuracion=t,a.loading=null,a.LoadedTabs[a.currentTab]=!0,a})}).catch(function(t){return e.setState({error:t,loading:null})})}},{key:"handleTabChange",value:function(e,t){this.setState(function(e){var a=Object(E.a)({},e);return a.LoadedTabs[t]=!0,a.currentTab=t,a})}},{key:"render",value:function(){var e=this.state,t=e.currentTab,a=e.LoadedTabs,n=e.error,o=e.loading,i=e.configuracion;return o?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:100}},r.a.createElement(g.i,{size:100}),r.a.createElement(g.L,{variant:"h4"},"CARGANDO...")):n?r.a.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:200}},r.a.createElement(g.L,{variant:"h6"},"Ocurri\xf3 un error al cargar tu configuraci\xf3n"),r.a.createElement(g.L,{variant:"subtitle1"},n.message),r.a.createElement(g.L,{variant:"body1"},n.code," ",n.status)):r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%"}},r.a.createElement(g.I,{variant:"fullWidth",onChange:this.handleTabChange,value:t,indicatorColor:"primary",textColor:"primary"},r.a.createElement(g.C,{label:"Informaci\xf3n"}),r.a.createElement(g.C,{label:"Cobertura y Tarifas"}),r.a.createElement(g.C,{label:"Horarios de Atenci\xf3n"})),r.a.createElement("div",{style:{display:0===t?"block":"none",flex:1}},a[0]&&r.a.createElement(le,{configuracion:i})),r.a.createElement("div",{style:{display:1===t?"block":"none",flex:1}},a[1]&&r.a.createElement(ge,{configuracion:i})),r.a.createElement("div",{style:{display:2===t?"block":"none",flex:1}},a[2]&&r.a.createElement(Ee,{configuracion:i})))}}]),t}(r.a.PureComponent),je=[{id:"orders",title:"Pedidos",Icon:f.o},{id:"products",title:"Productos",Icon:f.j},{id:"config",title:"Configuraci\xf3n",Icon:f.x,addDividerBefore:!0}],ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={current_step:""},a.handleMounted=a.handleMounted.bind(Object(h.a)(Object(h.a)(a))),D.storeID=e.store.nombre,D.START_LISTENING(),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.Notification?"granted"===Notification.permission?this.REMOVE_LISTENER=q.ListenOrderChanges():Notification.requestPermission().then(function(e){"granted"===e?this.REMOVE_LISTENER=q.ListenOrderChanges():console.log("User blocked notifications.")}).catch(function(e){console.error(e)}):console.log("Browser does not support notifications.")}},{key:"componentWillUnmount",value:function(){this.REMOVE_LISTENER&&this.REMOVE_LISTENER()}},{key:"handleMounted",value:function(e){this.setState({current_step:e})}},{key:"render",value:function(){var e=this,t=this.state.current_step,a=(t&&je.find(function(e){return e.id===t})).title;return r.a.createElement(p.a,null,r.a.createElement(R.Provider,{value:this.props.store},r.a.createElement(g.z,{style:{height:"100vh",width:"100%"}},r.a.createElement(b,{user:this.props.user,store:this.props.store,title:a,onLogOut:this.props.onLogOut}),r.a.createElement(v,{STEPS:je,current_step:t}),r.a.createElement("div",{style:{height:"calc(100% - 60px)",width:"calc(100% - 205px)",paddingLeft:205,paddingTop:60,overflow:"hidden"}},r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/orders",render:function(t){return r.a.createElement(J,Object.assign({},t,{store:e.props.store,onMounted:e.handleMounted,stepID:"orders"}))}}),r.a.createElement(m.b,{path:"/products",render:function(t){return r.a.createElement(oe,Object.assign({},t,{store:e.props.store,onMounted:e.handleMounted,stepID:"products"}))}}),r.a.createElement(m.b,{path:"/config",render:function(t){return r.a.createElement(Ce,Object.assign({},t,{onMounted:e.handleMounted,stepID:"config"}))}}),r.a.createElement(m.b,{exact:!0,path:"/"},r.a.createElement("div",{style:{paddingTop:100,width:"100%",textAlign:"center"}},r.a.createElement(g.L,{variant:"h4"},"BIENVENIDO!"),r.a.createElement(g.L,{variant:"subtitle2"},"RunFood Orders - Administrador"))))))))}}]),t}(r.a.Component),Se={marginTop:10,marginBottom:10},we=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).state={user:"",pdw:"",showPassword:!1,loading:!1,store:null},a.handleChange=a.handleChange.bind(Object(h.a)(Object(h.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(Object(h.a)(a))),a.handleTogglePassword=a.handleTogglePassword.bind(Object(h.a)(Object(h.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(Z.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.loading,r=a.user,o=a.pwd;if(!n){if(!r)return this.setState({error:{message:"Digite el usuario"}});if(!o)return this.setState({error:{message:"Digite la contrase\xf1a"}});this.setState({loading:!0}),D.LogIn({user:r,pwd:o,withStoresInfo:!0}).then(function(e){return t.props.onLogged({user:r,token:e.token,store:e.store})}).catch(function(e){return t.setState({error:e,loading:!1})})}}},{key:"handleTogglePassword",value:function(){this.setState(function(e){var t=Object(E.a)({},e);return t.showPassword=!t.showPassword,t})}},{key:"render",value:function(){var e=this.state,t=e.showPassword,a=e.loading,n=e.error,o=e.user,i=e.pwd;return r.a.createElement("div",{style:{padding:40,overflow:"auto"}},r.a.createElement(g.c,{style:{width:400,margin:"auto"}},r.a.createElement(g.f,{style:{padding:0}},r.a.createElement("form",{onSubmit:this.handleSubmit,style:{padding:20}},r.a.createElement(g.L,{style:{textAlign:"center"},variant:"h5"},"INICIO DE SESION"),r.a.createElement(g.J,{autoFocus:!0,disabled:a,required:!0,style:Object(E.a)({},Se),fullWidth:!0,label:"USUARIO",value:o||"",name:"user",onChange:this.handleChange,type:"email",InputProps:{startAdornment:r.a.createElement(g.s,{position:"start"},r.a.createElement(f.a,null))}}),r.a.createElement(g.J,{required:!0,fullWidth:!0,style:Object(E.a)({},Se),value:i||"",label:"CONTRASE\xd1A",name:"pwd",onChange:this.handleChange,type:t?"text":"password",InputProps:{endAdornment:r.a.createElement(g.s,{position:"end"},r.a.createElement(g.r,{onClick:this.handleTogglePassword},t?r.a.createElement(f.y,null):r.a.createElement(f.z,null)))}}),n&&r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(g.L,{color:"secondary",variant:"body2"},n.message," ",n.code&&n.code),r.a.createElement(g.L,{color:"secondary",variant:"body1"},n.status," | ",n.statusText)),r.a.createElement(g.b,{type:"submit",fullWidth:!0,style:Object(E.a)({},Se),variant:"outlined",disabled:a,color:"primary"},a?r.a.createElement(g.i,{size:20,color:"inherit"}):"ENTRAR")))))}}]),t}(r.a.Component);function Ie(e){e||(e=T()),i.a.render(r.a.createElement(ke,{user:e.user,store:e.store,onLogOut:xe}),document.getElementById("app"))}function Te(){i.a.render(r.a.createElement(we,{onLogged:Le}),document.getElementById("app"))}function Le(e){I(e),Ie()}function xe(){D.STOP_LISTENING(),I(),Te()}T()?Ie():Te()}},[[5599,2,1]]]);
//# sourceMappingURL=main.b65488d9.chunk.js.map