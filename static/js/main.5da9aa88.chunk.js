(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5564:function(e,t,a){e.exports=a(5914)},5914:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(34),r=a.n(o),l=a(112),c=a(11),s=a(18),d=a(20),u=a(22),h=a(21),m=a(23),p=a(4),g=a(3),f=a(68),b=a(173),v=a(19),E="http://runfoodapp.ddns.net:10000/data/";function y(){var e=window.location,t=e.href,a=e.origin,n=t.substring(a.length,t.length).split("/");return(n&&n[1]||"").replace(/#/g,"")}function O(e,t){return fetch(e,t||{method:"GET",cache:"reload",mode:"cors"}).then(function(e){return e.ok?e.json():e.json().catch(function(){return e.text().then(function(t){throw{message:t,status:e.status,statusText:e.statusText}})}).then(function(t){throw Object(c.a)({},t,{status:e.status,statusText:e.statusText})})}).catch(function(e){if("Failed to fetch"===e.message)throw{message:"Este servicio no se encuentra disponible por el momento. Intentelo m\xe1s tarde.",status:0};throw e.message||(e.message=e.statusText),e})}var C={GetProducts:function(){return O(E+y()+"/product")},GetProduct:function(e){return O(E+y()+"/product/"+e)},SaveOrder:function(e){return O(E+y()+"/order",{body:JSON.stringify(e),method:"POST",mode:"cors",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}})},GetStoreData:function(){return O(E+y()+"?withgooglemapskey=1")}};function x(e,t){window.localStorage.setItem(e,t),console.log("Preferences."+e+" stored")}function j(e){var t=window.localStorage.getItem(e);try{t=JSON.parse(t)}catch(a){console.warn("Preferences."+e,a)}return"true"===t||"false"===t?"true"===t:(console.log("Preferences."+e+" sent",t),null===t||void 0===t?null:t)}var S=function e(){Object(s.a)(this,e),this.activeStep=0,this.items=[],this.productList=[],this.forma_pago=1,this.nota="",this.contactData={telefono:"",nombre:"",email:""},this.invoiceData={documento:1,identificacion:"",razonsocial:"",telefono:"",direccion:"",email:""},this.direccion={numero_secundario:"",referencia:"",position:null},this.start_timestamp=(new Date).valueOf(),this.orderNumber=null,this.loading="data"},k=a(69),w=a(42),D=function(e){function t(e){var a;if(Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={nombre:"",descripcion:"",pvpWithTaxes:0,cantidad:1,imgSrc:"",nota:"",loading:!0},a.handleInput=a.handleInput.bind(Object(p.a)(Object(p.a)(a))),a.handleDone=a.handleDone.bind(Object(p.a)(Object(p.a)(a))),a.handleCantidad=a.handleCantidad.bind(Object(p.a)(Object(p.a)(a))),a.handleExit=a.handleExit.bind(Object(p.a)(Object(p.a)(a))),a.ID=e.match.params.id,e.choosenItems&&e.choosenItems.length){var n=e.choosenItems.find(function(e){return e.id===+a.ID});n&&(a.state=Object(c.a)({},n,{loading:!1}))}return a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.state.loading){var t=this.props.productList;if(t&&t.length){var a=t.find(function(t){return t.id===+e.ID});if(a)return this.setState(Object(c.a)({loading:!1},a))}alert("No se encontr\xf3 el producto en la lista. Recargue la pantalla.")}}},{key:"handleCantidad",value:function(e){var t=e.currentTarget.name;this.setState(function(e){var a=Object(c.a)({},e),n=a.cantidad;return"add"===t&&(n=(n||0)+1),"remove"===t&&(n=n<=0?0:n-1),a.cantidad=n,console.log("Product Details new cantidad ",n),a})}},{key:"handleInput",value:function(e){var t=e.target;this.setState(Object(k.a)({},t.name,t.value))}},{key:"handleDone",value:function(){this.props.onDone(Object(c.a)({},this.state)),this.handleExit()}},{key:"handleExit",value:function(){var e=this.props,t=e.match,a=e.history,n=t.path.substr(0,t.path.indexOf("/view-product/:id"));a.push(n)}},{key:"render",value:function(){console.log("Product Details rendered");var e=this.state;return i.a.createElement(i.a.Fragment,null,e.loading&&i.a.createElement(g.c,{open:!0,classes:{paper:this.props.classes.loadingPaper}},i.a.createElement("div",{style:{marginTop:100,marginBottom:100,textAlign:"center"}},i.a.createElement(g.b,{size:30}),i.a.createElement(g.t,{variant:"h5"},"Cargando..."))),i.a.createElement(g.c,{open:!e.loading,classes:{paper:this.props.classes.dialogPaper}},i.a.createElement(g.e,{style:{padding:0,maxWidth:350,maxHeight:"100%"}},i.a.createElement(g.f,{onClick:this.handleExit,color:"secondary",style:{float:"right",right:10,top:10,position:"absolute"}},i.a.createElement(v.e,null)),i.a.createElement("img",{style:{maxWidth:"100%",maxHeight:"40%"},src:e.imgSrc||"",alt:e.nombre}),i.a.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"row"}},i.a.createElement(g.t,{style:{margin:10,flex:1},variant:"title"},e.nombre),i.a.createElement(g.t,{style:{margin:10},variant:"title"},"$ ",e.pvpWithTaxes.toFixed(2))),i.a.createElement(g.t,{style:{margin:10},variant:"body2"},e.descripcion),i.a.createElement("div",{style:{width:"100%",textAlign:"center",marginTop:20,marginBottom:20}},i.a.createElement(P,{onClick:this.handleCantidad,name:"add"},i.a.createElement(v.a,null)),i.a.createElement(g.t,{style:{display:"inline-block",marginLeft:20,marginRight:20},variant:"h6"},e.cantidad||0),i.a.createElement(P,{disabled:e.cantidad<=0,onClick:this.handleCantidad,name:"remove"},i.a.createElement(v.p,null))),i.a.createElement("div",{style:{width:"95%",margin:"auto"}},i.a.createElement(g.s,{value:e.nota,inputProps:{maxLength:200},onChange:this.handleInput,name:"nota",color:"default",placeholder:"Ej. Sin Salsa, verduras aparte, etc.",label:"Agrega una nota:",variant:"outlined",multiline:!0,rows:"3",fullWidth:!0}))),i.a.createElement(g.d,null,i.a.createElement(g.a,{type:"button",onClick:this.handleDone,color:"primary",variant:"outlined"},"AGREGAR"))))}}]),t}(i.a.Component),I=Object(w.withStyles)(function(e){return{dialogPaper:{maxWidth:450,maxHeight:"calc(100% - 20px)",marginTop:10,marginBottom:10},loadingPaper:{marginLeft:10,marginRight:10,width:"calc(100% - 20px)",maxWidth:450}}})(Object(b.h)(D));function P(e){var t={height:50,width:50,border:"1px solid gray"};return e.disabled&&delete t.border,i.a.createElement(g.j,{disabled:e.disabled,onClick:e.onClick,name:e.name,style:t},e.children)}var L={root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"},gridList:{flexWrap:"nowrap",transform:"translateZ(0)"}},M=function(e){function t(e){var a;return Object(s.a)(this,t),a=Object(u.a)(this,Object(h.a)(t).call(this,e)),e.onMounted&&e.onMounted(e.stepIndex),a.handleClick=a.handleClick.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"handleClick",value:function(e){this.props.history.push(this.props.match.path+"/view-product/"+e.currentTarget.id)}},{key:"render",value:function(){var e=this;console.log("TakeOrder rendered");var t=this.props,a=t.productList,n=t.style,o=t.choosenItems,r=t.match,l=t.onItemChange,s=a.reduce(function(e,t){var a=e.find(function(e){return e.group===t.grupo});return a||(a={group:t.grupo,items:[]},e.push(a)),a.items.push(t),e},[]);return s&&s.length?i.a.createElement("div",{style:Object(c.a)({},n,{textAlign:"left",overflowX:"hidden",overflowY:"auto"})},s.map(function(t,a){return i.a.createElement(T,{key:a,onClick:e.handleClick,style:{marginTop:10,marginBottom:10},title:t.group,items:t.items,choosenItems:o})}),i.a.createElement(b.c,{path:r.path+"/view-product/:id"},i.a.createElement(I,{choosenItems:o||[],onDone:l,productList:a}))):i.a.createElement("div",{style:Object(c.a)({},n,{textAlign:"center"})},i.a.createElement(g.t,{variant:"h6"},"Esta tienda no tiene productos disponibles. Intenta nuevamente despu\xe9s."))}}]),t}(i.a.PureComponent);function T(e){return i.a.createElement("div",{style:Object(c.a)({},e.style)},i.a.createElement(g.t,{variant:"h6",style:{marginLeft:10}},e.title),i.a.createElement(g.g,{cols:2.5,style:L.gridList},e.items.map(function(t){var a=(e.choosenItems||[]).find(function(e){return e.id===t.id});return function(e,t,a){var n={title:e.nombre,actionPosition:"right",subtitle:e.pvpWithTaxes.toFixed(2)};t&&(n.actionIcon=i.a.createElement(g.t,{variant:"body2",style:{color:"#fff",marginRight:5}},"x",t));var o={cursor:"pointer"};t&&(o.border="3px dashed #f50057");return i.a.createElement(g.h,{style:o,key:e.id,onClick:a,id:e.id,color:"inherit"},i.a.createElement("img",{src:e.imgSrc,alt:e.nombre}),i.a.createElement(g.i,n))}(t,a&&a.cantidad,e.onClick)})))}var A=function(e){function t(e){var a;return Object(s.a)(this,t),a=Object(u.a)(this,Object(h.a)(t).call(this,e)),e.onMounted&&e.onMounted(e.stepIndex),a.handleClick=a.handleClick.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"handleClick",value:function(e){var t=e.currentTarget.id;this.props.history.push(this.props.match.url+"/view-product/"+t)}},{key:"render",value:function(){var e=this;console.log("ConfirmOrder rendered");var t=this.props;return i.a.createElement("div",{style:{paddingLeft:10,paddingRight:10,overflow:"auto",flex:1}},i.a.createElement(g.k,{style:{marginBottom:10},dense:!0},(t.items||[]).map(function(t){return a=t,n=e.handleClick,i.a.createElement(g.l,{key:a.id,button:!0,onClick:n,id:a.id},i.a.createElement(g.n,{primary:a.nombre,secondary:a.nota||""}),i.a.createElement(g.m,null,i.a.createElement(g.t,{style:{margin:0,padding:0},variant:"h6"},"x",a.cantidad)));var a,n})),i.a.createElement("div",{style:{width:"100%",textAlign:"center"}},i.a.createElement(g.s,{label:"Agrega una nota a tu pedido",placeholder:"Ej. Sin cubiertos, sin salas extra, etc.",multiline:!0,name:"nota",inputProps:{maxLength:200},value:t.nota,onChange:t.onInputChange,rows:2,style:{width:"95%",margin:"auto",marginBottom:10,marginTop:10}}),i.a.createElement(g.s,{label:"Selecciona tu m\xe9todo de pago",select:!0,value:t.forma_pago,name:"forma_pago",onChange:t.onInputChange,variant:"outlined",style:{width:"95%",margin:"auto",marginBottom:10,marginTop:10},SelectProps:{native:!0}},i.a.createElement("option",{value:1},"Efectivo"),i.a.createElement("option",{value:2},"Tarjeta de Cr\xe9dito/Debito"))),i.a.createElement(b.c,{path:t.match.path+"/view-product/:id"},i.a.createElement(I,{productList:t.productList,choosenItems:t.items||[],onDone:t.onItemChange})))}}]),t}(i.a.PureComponent);var B=function(e,t){if(e||(e=""),3!==(t=+t)){if(1===t){if(13!==e.length)return"N\xfamero de RUC debe tener 13 digitos";if(13===e.length&&"9999999999999"===e)return}return 2===t&&10!==e.length?"N\xfamero de Cedula debe tener 10 digitos":function(e,t,a,n){var i="",o=!1;if(t&&(A=e,""===A||void 0==A||null==A||"undefined"==A))i="",o=!0;else if(function(e){return!isNaN(parseFloat(e))}(e)){e.length<10?i="El numero de Cedula debe tener 10 d\xedgitos":e.length>10&&e.length<13?i="El numero de RUC debe tener 13 d\xedgitos":e.length>13&&(i="El numero tiene m\xe1s de 13 d\xedgitos");var r,l,c,s,d,u,h,m,p,g=0,f=!1,b=!1,v=!1,E=11,y=e.substr(0,1),O=e.substr(1,1),C=e.substr(2,1),x=e.substr(3,1),j=e.substr(4,1),S=e.substr(5,1),k=e.substr(6,1),w=e.substr(7,1),D=e.substr(8,1),I=e.substr(9,1);if(N(y)||(i="El digito 1 no es un n\xfamero"),N(O)||(i="El digito 2 no es un n\xfamero"),N(C)||(i="El digito 3 no es un n\xfamero"),N(x)||(i="El digito 4 no es un n\xfamero"),N(j)||(i="El digito 5 no es un n\xfamero"),N(S)||(i="El digito 6 no es un n\xfamero"),N(k)||(i="El digito 7 no es un n\xfamero"),N(w)||(i="El digito 8 no es un n\xfamero"),N(D)||(i="El digito 9 no es un n\xfamero"),N(I)||(i="El digito 10 no es un n\xfamero"),e.length>10){var P=e.substr(10,1),L=e.substr(10,1),M=e.substr(10,1);P&&!N(P)&&(i="El digito 11 no es un n\xfamero"),L&&!N(L)&&(i="El digito 12 no es un n\xfamero"),M&&!N(M)&&(i="El digito 13 no es un n\xfamero")}7!=C&&8!=C||(i="El tercer d\xedgito ingresado es inv\xe1lido",o=!1),C<6?(v=!0,(r=2*y)>=10&&(r-=9),(l=1*O)>=10&&(l-=9),(c=2*C)>=10&&(c-=9),(s=1*x)>=10&&(s-=9),(d=2*j)>=10&&(d-=9),(u=1*S)>=10&&(u-=9),(h=2*k)>=10&&(h-=9),(m=1*w)>=10&&(m-=9),(p=2*D)>=10&&(p-=9),E=10):6==C?(b=!0,r=3*y,l=2*O,c=7*C,s=6*x,d=5*j,u=4*S,h=3*k,m=2*w,p=0):9==C&&(f=!0,r=4*y,l=3*O,c=2*C,s=7*x,d=6*j,u=5*S,h=4*k,m=3*w,p=2*D);var T=0==(g=(r+l+c+s+d+u+h+m+p)%E)?0:E-g;1==b?(T!=D&&(i="El ruc de la empresa del sector p\xfablico es incorrecto.",o=!1),"0001"!=e.substr(9,4)&&(i="El ruc de la empresa del sector p\xfablico debe terminar con 0001",o=!1)):1==f?(T!=I&&(i="El ruc de la empresa del sector privado es incorrecto.",o=!1),"001"!=e.substr(10,3)&&(i="El ruc de la empresa del sector privado debe terminar con 001",o=!1)):1==v&&(T!=I&&(i="El n\xfamero de c\xe9dula de la persona natural es incorrecto.",o=!1),e.length>10&&"001"!=e.substr(10,3)&&(i="El ruc de la persona natural debe terminar con 001",o=!1)),o=!0}else i="Este campo solo admite numeros";var A;return o&&""==i?(a&&a(),""):(""==i&&(i="La cantidad de digitos no corresponde a Cedula o RUC"),n&&n(i),i)}(e,!1)}};function N(e){return e>="0"&&e<="9"}var R={tel:function(e){if(e){if(e.length<7)return"El n\xfamero de telefono debe tener al menos 7 digitos";for(var t=0;t<e.length;t++)if("+"!==e[t]&&!N(e[t])&&""!==e[t].trim())return"El n\xfamero debe tener uno de estos formatos: '09123456789' o '+5931234567890'"}},email:function(e){if(e){if(e.length<5)return"El email no est\xe1 escrito correctamente";var t=e.split("@");return 2!==t.length?"El email no est\xe1 escrito correctamente":t[1].indexOf(".")>=0?e.trim().indexOf(" ")>=0?"El email no est\xe1 escrito correctamente":e.trim().indexOf("\t")>=0?"El email no est\xe1 escrito correctamente":e.trim().indexOf("\r")>=0?"El email no est\xe1 escrito correctamente":void 0:"El email no est\xe1 escrito correctamente"}}},_={textField:{marginTop:10,marginBottom:10},content:{paddingTop:10,paddingLeft:10,paddingRight:10,paddingBottom:0}},W=function(e){function t(e){var a;if(Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={documento:1,identificacion:"",razonSocial:"",telefono:"",direccion:"",email:""},e.data)for(var n in e.data)e.data.hasOwnProperty(n)&&(a.state[n]=e.data[n]);return a.handleChange=a.handleChange.bind(Object(p.a)(Object(p.a)(a))),a.handleExit=a.handleExit.bind(Object(p.a)(Object(p.a)(a))),a.handleDone=a.handleDone.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(k.a)({},a,n))}},{key:"handleExit",value:function(){var e=this.props,t=e.match,a=e.history,n=t.path.substr(0,t.path.indexOf("/invoice-data"));a.push(n)}},{key:"handleDone",value:function(e){e.preventDefault();var t=function(e){var t=e.documento,a=e.identificacion,n=e.razonSocial,i=e.telefono,o=e.direccion,r=e.email,l=a||"",c=n||"",s=i||"",d=o||"",u=r||"",h="";if(l.length||c.length||s.length||d.length||u.length){if(!l.length)return"Agregue el numero de identificacion";if(!c.length)return"Agregue la Razon Social";if(h=B(a,t))return h;if(h=s&&R.tel(s))return h;if(h=u&&R.email(u))return h}}(this.state);t?alert(t):(this.props.onDone&&this.props.onDone(this.state),this.handleExit())}},{key:"render",value:function(){var e=this.state.identificacion?B(this.state.identificacion,this.state.documento):"",t={};e&&(t.error=!0,t.helperText=e);var a=this.state.identificacion&&!(this.state.razonSocial||"").trim()?"Esta campo no puede estar vac\xedo":"",n={},o=R.tel(this.state.telefono);o&&(n.error=!0,n.helperText=o);var r={},l=R.email(this.state.email);l&&(r.error=!0,r.helperText=l);var c=e||a||o||l;return i.a.createElement(g.c,{open:!0},i.a.createElement("form",{onSubmit:this.handleDone},i.a.createElement(g.e,{style:_.content},i.a.createElement(g.s,{value:this.state.documento,name:"documento",onChange:this.handleChange,select:!0,SelectProps:{native:!0},fullWidth:!0,label:"Documento",style:_.textField},i.a.createElement("option",{value:1},"RUC"),i.a.createElement("option",{value:2},"Cedula"),i.a.createElement("option",{value:3},"Pasaporte")),i.a.createElement(g.s,Object.assign({name:"identificacion",inputProps:{maxLength:20},onChange:this.handleChange,label:"# de Identificacion",value:this.state.identificacion||"",style:_.textField,fullWidth:!0},t)),i.a.createElement(g.s,{name:"razonSocial",inputProps:{maxLength:200},onChange:this.handleChange,label:"Razon Social",value:this.state.razonSocial||"",multiline:!0,rows:2,style:_.textField,fullWidth:!0}),i.a.createElement(g.s,Object.assign({name:"telefono",inputProps:{maxLength:50},onChange:this.handleChange,label:"Telefono",value:this.state.telefono||"",style:_.textField,fullWidth:!0},n)),i.a.createElement(g.s,{name:"direccion",inputProps:{maxLength:300},onChange:this.handleChange,label:"Direccion",value:this.state.direccion||"",multiline:!0,rows:3,style:_.textField,fullWidth:!0}),i.a.createElement(g.s,Object.assign({name:"email",inputProps:{maxLength:150},onChange:this.handleChange,label:"Email",value:this.state.email||"",style:_.textField,fullWidth:!0},r))),i.a.createElement(g.d,null,i.a.createElement(g.a,{type:"button",onClick:this.handleExit,color:"secondary",variant:"outlined"},"SALIR"),i.a.createElement(g.a,{disabled:c,type:"submit",color:"primary",variant:"outlined"},"AGREGAR"))))}}]),t}(i.a.PureComponent);var F=Object(w.withStyles)(function(e){return{paper:{maxHeight:"calc(100% - 30px)",marginTop:15,marginBottom:15}}})(W),G={root:{padding:"20px 10px",flex:1},textFiel:{marginTop:10,marginBottom:10}},z=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={telefono_error:"",email_error:""},e.onMounted&&e.onMounted(e.stepIndex),a.handleClick=a.handleClick.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"handleClick",value:function(){this.props.history.push(this.props.match.path+"/invoice-data")}},{key:"render",value:function(){var e=this.props,t=R.tel(e.data.telefono),a={};t&&(a.error=!0,a.helperText=t);var n=R.email(e.data.email),o={};return n&&(o.error=!0,o.helperText=n),i.a.createElement("div",{style:G.root},i.a.createElement(g.s,{autoFocus:!0,label:"Nombre (Nombres y Apellidos)*",fullWidth:!0,inputProps:{maxLength:300},style:G.textField,name:"contactData.nombre",value:e.data.nombre,onChange:e.onInputChange}),i.a.createElement(g.s,Object.assign({label:"Telefono*",fullWidth:!0,inputProps:{maxLength:50,type:"phone"},style:G.textField,name:"contactData.telefono",value:e.data.telefono,onChange:e.onInputChange},a)),i.a.createElement(g.s,Object.assign({label:"Email",fullWidth:!0,inputProps:{maxLength:150,type:"email"},style:G.textField,name:"contactData.email",value:e.data.email,onChange:e.onInputChange},o)),i.a.createElement(g.t,{style:{marginTop:20},variant:"body2"},"NECESITAS FACTURA?"),i.a.createElement("div",{style:{width:"100%",marginBottom:10,textAlign:"center"}},i.a.createElement(g.a,{variant:"outlined",color:"secondary",size:"small",style:{width:"90%",margin:"auto"},onClick:this.handleClick},"Agregar Datos de Facturaci\xf3n")),i.a.createElement(b.c,{path:"".concat(e.match.path,"/invoice-data"),render:function(t){return i.a.createElement(F,Object.assign({},t,{data:e.invoiceData,onDone:e.onInvoiceDataChange}))}}))}}]),t}(i.a.Component),V=a(111),U=a(295),H=a.n(U),J=a(296),Z={},q={fields:{marginTop:10,marginBottom:10}},K={lat:-.263496,lng:-78.488272},Y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={loading:!1,defaultCenter:{},latLng:null,defaultZoom:12,bounds:null},e.onMounted&&e.onMounted(e.stepIndex),a.handleMapClick=a.handleMapClick.bind(Object(p.a)(Object(p.a)(a))),a.handlePlacesChanged=a.handlePlacesChanged.bind(Object(p.a)(Object(p.a)(a))),a.handleSearchBoxMounted=a.handleSearchBoxMounted.bind(Object(p.a)(Object(p.a)(a))),a.handleMapMounted=a.handleMapMounted.bind(Object(p.a)(Object(p.a)(a))),a.handleBoundsChanged=a.handleBoundsChanged.bind(Object(p.a)(Object(p.a)(a))),a.handleLocationClick=a.handleLocationClick.bind(Object(p.a)(Object(p.a)(a))),a.state.showLocationButton=j("geo"),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"handleSearchBoxMounted",value:function(e){Z.searchBox=e}},{key:"handleMapMounted",value:function(e){Z.map=e}},{key:"handleBoundsChanged",value:function(){this.setState({bounds:Z.map.getBounds()})}},{key:"handlePlacesChanged",value:function(){var e=Z.searchBox.getPlaces(),t=new window.google.maps.LatLngBounds;e.forEach(function(e){e.geometry.viewport?t.union(e.geometry.viewport):t.extend(e.geometry.location)});var a=e.map(function(e){return{position:e.geometry.location,name:e.name}}),n=this.state.defaultCenter;a&&a.length&&(n=a[0]),this.setState({center:n.position}),this.props.onPositionChanged({lat:n.position.lat(),lng:n.position.lng(),name:n.name})}},{key:"componentWillMount",value:function(){var e=this,t=this.props.direccion;if(t&&t.position)return this.setState({center:Object(c.a)({},t.position),defaultZoom:20});navigator.geolocation.getCurrentPosition(function(t){var a={lat:t.coords.latitude,lng:t.coords.longitude,name:"Ubicaci\xf3n Actual"};e.setState({defaultCenter:Object(c.a)({},a,{isCurrentLocation:!0}),defaultZoom:20,loading:!1}),e.props.onPositionChanged(a)},function(t){e.setState({loading:!1,defaultCenter:Object(c.a)({},K),markerName:""})})}},{key:"handleMapClick",value:function(e){this.props.onPositionChanged({lat:e.latLng.lat(),lng:e.latLng.lng(),name:""})}},{key:"handleLocationClick",value:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){var a={lat:t.coords.latitude,lng:t.coords.longitude,name:"Ubicaci\xf3n Actual"};e.props.onPositionChanged(a),e.setState({center:a})},function(t){var a={center:Object(c.a)({},e.state.defaultCenter)};a.center.isCurrentLocation&&(delete a.center.isCurrentLocation,e.props.onPositionChanged(a.center)),e.setState(a)})}},{key:"render",value:function(){var e=this.props,t=e.direccion,a=e.onInputChange,n=e.API_KEY,o=this.state,r=o.defaultCenter,l=o.defaultZoom,c=o.center,s=o.bounds,d=o.showLocationButton;return i.a.createElement("div",{style:{overflow:"auto",paddingLeft:10,paddingRight:10,flex:1}},i.a.createElement(X,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=".concat(n||"","&v=3.exp&libraries=geometry,drawing,places"),containerElement:i.a.createElement("div",{style:{height:"300px"}}),loadingElement:i.a.createElement("div",{style:{height:"100%"}}),mapElement:i.a.createElement("div",{style:{height:"100%"}}),onClick:this.handleMapClick,defaultZoom:l,onPlacesChanged:this.handlePlacesChanged,onSearchBoxMounted:this.handleSearchBoxMounted,onMapMounted:this.handleMapMounted,marker:t.position,center:c||r,onBoundsChanged:this.handleBoundsChanged,searchBoxBounds:s,onLocationClick:this.handleLocationClick,showLocationButton:d}),i.a.createElement(g.s,{name:"direccion.numero_secundario",value:t.numero_secundario,onChange:a,inputProps:{maxLength:100},label:"Numero",placeholder:"Ej. Dpto 101, Oficina 304, Manzana 10 Villa 4, etc.",fullWidth:!0,style:q.fields}),i.a.createElement(g.s,{name:"direccion.referencia",value:t.referencia,onChange:a,inputProps:{maxLength:200},label:"Referencia*",placeholder:"Ej. Al lado de la panaderia 'El Pan de Cada Dia'",fullWidth:!0,style:q.fields}))}}]),t}(i.a.PureComponent),X=Object(V.withScriptjs)(Object(V.withGoogleMap)(function(e){var t=window.google;return i.a.createElement(V.GoogleMap,Object.assign({},e,{ref:e.onMapMounted,options:{disableDefaultUI:!0,zoomControl:!0,clickableIcons:!1}}),i.a.createElement(H.a,{bounds:e.searchBoxBounds,onPlacesChanged:e.onPlacesChanged,controlPosition:t.maps.ControlPosition.TOP_LEFT,ref:e.onSearchBoxMounted},i.a.createElement("div",{style:{display:"flex",flexDirection:"row",width:"calc(100% - 10px)",margin:5}},i.a.createElement("input",{type:"text",onChange:function(e){e.preventDefault(),e.stopPropagation()},placeholder:"Busca tu direcci\xf3n aqui",style:{flex:1,boxSizing:"border-box",border:"1px solid transparent",height:40,padding:"0 10px",borderRadius:"3px",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.3)",fontSize:"14px",outline:"none",textOverflow:"ellipses"}}),e.showLocationButton?i.a.createElement(g.a,{style:{maxHeight:40,padding:5,minWidth:40,background:"#fff",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.3)"},variant:"outlined"},i.a.createElement(v.g,null)):null)),e.marker?i.a.createElement(J.MarkerWithLabel,{x:!0,labelAnchor:new window.google.maps.Point(0,0),position:e.marker,labelStyle:{background:"#fff",border:"1px solid grey",padding:"10px"},labelVisible:Boolean(e.marker.name)},i.a.createElement(g.t,null,e.marker.name)):null)})),$=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={loading:!1},e.onMounted&&e.onMounted(e.stepIndex),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.loading,a=e.error,n=e.ws;return i.a.createElement("div",{style:{textAlign:"center",overflow:"auto",padding:10}},t?i.a.createElement(Q,null):a?i.a.createElement(ee,a):i.a.createElement(te,{ws:n}))}}]),t}(i.a.Component);function Q(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.b,{size:40}),i.a.createElement(g.t,{vaiant:"h5"},"Guardando..."))}function ee(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.t,{variant:"h6",color:"secondary"},e.message),i.a.createElement(g.t,{variant:"caption",color:"secondary"},e.code," | ",e.status),i.a.createElement(g.a,{variant:"outlined",color:"primary",fullWidth:!0,style:{marginTop:20}},"Regresar al Pedido ",i.a.createElement(v.f,null)))}function te(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(v.d,{fontSize:"large",style:{margin:20}}),i.a.createElement(g.t,{variant:"h5"},"Tu pedido ha sido recibido!"),i.a.createElement(g.t,{variant:"body2"},"En un momento nos comunicaremos contigo para coordinar la entrega de tu pedido. Mantente pendiente a tu telefono."),i.a.createElement(g.a,{component:"a",href:"/",style:{margin:10},variant:"contained",color:"primary"},"NUEVO PEDIDO"),e.ws?i.a.createElement(g.a,{target:"_blank",style:{margin:10},variant:"outlined",color:"secondary",component:"a",href:e.ws},"CHATEA CON NOSOTROS",i.a.createElement("img",{alt:"Whatsapp",src:"./ws.png",style:{height:20,width:20,marginLeft:5}})):null)}var ae=function(e,t){return function(a){function n(e){var a;Object(s.a)(this,n),(a=Object(u.a)(this,Object(h.a)(n).call(this,e))).state={render:!0};var i=e.onValidate(t);return i>=0&&(e.history.push("/"+i),a.state.render=!1),a}return Object(m.a)(n,a),Object(d.a)(n,[{key:"render",value:function(){return this.state.render?i.a.createElement(e,Object.assign({stepIndex:t},this.props)):null}}]),n}(i.a.Component)},ne=ae(M,0),ie=ae(A,1),oe=ae(z,2),re=ae(Y,3),le=ae($,4),ce=[{t:"Elige tus productos",icon:v.b,currentIcon:v.q},{t:"Confirma tu pedido",icon:v.o,currentIcon:v.n},{t:"Registra tus datos",icon:v.k,currentIcon:v.j},{t:"Ingresa tu ubicaci\xf3n",icon:v.m,currentIcon:v.l}],se=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state=new S,a.handleActivateStep=a.handleActivateStep.bind(Object(p.a)(Object(p.a)(a))),a.handleItemChange=a.handleItemChange.bind(Object(p.a)(Object(p.a)(a))),a.handleInputChange=a.handleInputChange.bind(Object(p.a)(Object(p.a)(a))),a.handleInvoiceDataChange=a.handleInvoiceDataChange.bind(Object(p.a)(Object(p.a)(a))),a.handlePositionChanged=a.handlePositionChanged.bind(Object(p.a)(Object(p.a)(a))),a.handleGuardar=a.handleGuardar.bind(Object(p.a)(Object(p.a)(a))),a.validateStep=a.validateStep.bind(Object(p.a)(Object(p.a)(a))),a.handleValidateStep=a.handleValidateStep.bind(Object(p.a)(Object(p.a)(a))),a.handleNextClick=a.handleNextClick.bind(Object(p.a)(Object(p.a)(a))),a.state.contactData=j("contactData")||a.state.contactData,a.state.invoiceData=j("invoiceData")||a.state.invoiceData,a.state.direccion=j("direccion")||a.state.direccion,a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"handleValidateStep",value:function(e){if(this.state.orderNumber){var t=Object(c.a)({},new S,{loading:!1,productList:Object(l.a)(this.state.productList)});return t.contactData=j("contactData")||t.contactData,t.invoiceData=j("invoiceData")||t.invoiceData,t.direccion=j("direccion")||t.direccion,this.setState(t),0}var a=e-1,n=void 0;if(e>=0)for(;a>=0;){this.validateStep(a)&&(n=a),a--}return n}},{key:"validateStep",value:function(e){if((0===e||1===e)&&!this.state.items.length)return"Para continuar seleccione la menos un producto";if(1===e&&!this.state.forma_pago)return"Seleccione el M\xe9todo de Pago";if(2===e&&this.state.contactData){var t=this.state.contactData;if(!t.nombre)return"Agregue un nombre de contacto";if(!t.telefono)return"Agregue un telefono de contacto";var a=R.tel(t.telefono);if(a)return a;if(a=R.email(t.email))return a}if(3===e&&this.state.direccion){var n=this.state.direccion;if(!n.position)return"Confirme su ubicaci\xf3n en el mapa.";if(!n.referencia)return"Agregue la referencia de la direccion de entrega."}}},{key:"componentDidMount",value:function(){var e=this;C.GetStoreData().then(function(t){return e.setState(Object(c.a)({},t))}).then(function(t){return C.GetProducts().then(function(t){return e.setState({productList:t,loading:!1},function(){return console.info("Se han cargado los productos al estado")})})}).catch(function(t){if(console.dir(t),404===t.status)return e.setState({loading:!1,products:[]});e.setState({loading:!1,error:Object(c.a)({},t)})})}},{key:"handleActivateStep",value:function(e){this.setState({activeStep:e})}},{key:"handleInputChange",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(function(e){var t=Object(c.a)({},e);if(a.indexOf(".")>=0){for(var i=a.split("."),o=i.pop(),r=t,l=0;l<i.length;l++)r=r[i[l]];r[o]=n}else t[a]=n;return t})}},{key:"whatsAppURL",value:function(){var e=this.state,t=e.ws_phone,a=e.ws_msg,n=e.contactData,i=e.orderNumber;if(!t||!a)return"";var o=a.replace(/__NAME__/g,n.nombre).replace(/__ORDER_NUMER__/g,i);return"https://api.whatsapp.com/send?"+"phone=".concat(t,"&")+"text=".concat(encodeURIComponent(o))}},{key:"handleItemChange",value:function(e){var t=this.state.items.find(function(t){return t.id===e.id});if(!t&&e.cantidad){var a=Object(l.a)(this.state.items);return a.push(e),this.setState({items:a})}if(t){var n=Object(l.a)(this.state.items),i=n.indexOf(t);e.cantidad?n[i]=e:n.splice(i,1),this.setState({items:n})}}},{key:"handleInvoiceDataChange",value:function(e){this.setState({invoiceData:e}),e?x("invoiceData",JSON.stringify(e)):x("invoiceData")}},{key:"handlePositionChanged",value:function(e){this.setState(function(t){var a=Object(c.a)({},t);return a.direccion=Object(c.a)({},a.direccion),a.direccion.position=e,a})}},{key:"handleNextClick",value:function(){var e=this.state,t=e.contactData,a=e.direccion,n=e.activeStep;2===n&&t&&x("contactData",JSON.stringify(t)),3===n&&a&&x("direccion",JSON.stringify(a))}},{key:"handleGuardar",value:function(e){var t=this;this.handleActivateStep(e),this.setState({loading:"guardar",errGuardar:null});var a=Object(c.a)({},this.state);return delete a.products,delete a.loading,delete a.error,delete a.errGuardar,a.end_timestamp=(new Date).valueOf(),C.SaveOrder(a).then(function(e){t.setState({loading:!1,orderNumber:e.numero,errGuardar:null})}).catch(function(e){t.setState({loading:!1,errGuardar:e})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.activeStep,n=t.productList,o=t.loading,r=t.error,l=t.items,c=t.forma_pago,s=t.nota,d=t.invoiceData,u=t.contactData,h=t.direccion,m=t.errGuardar,p=t.orderNumber;return i.a.createElement(f.a,null,i.a.createElement(g.o,{style:{maxHeight:"100%",minHeight:"100%",margin:"auto",maxWidth:700,display:"flex",flexDirection:"column"}},i.a.createElement(g.r,{alternativeLabel:!0,activeStep:a},ce.map(function(e,t){return function(e,t,a){var n={};a===t&&(n={icon:i.a.createElement(e.currentIcon,null)});t>a&&(n={icon:i.a.createElement(e.icon,null)});return i.a.createElement(g.p,{key:t},i.a.createElement(g.q,n,e.t))}(e,t,a)})),i.a.createElement("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}},r?i.a.createElement("div",{style:{flex:1,textAlign:"center",padding:20}},i.a.createElement(g.t,{variant:"h6",color:"secondary"},r.message),i.a.createElement(g.a,{fullWidth:!0,style:{marginTop:20,marginBottom:20},onClick:function(e){return window.location.reload()},variant:"outlined",color:"primary"},"REINTENTAR")):"data"===o?i.a.createElement("div",{style:{flex:1,textAlign:"center",padding:20}},i.a.createElement(g.b,{size:40}),i.a.createElement(g.t,{color:"primary",variant:"h6"},"Obteniendo informaci\xf3n de la Tienda...")):i.a.createElement(i.a.Fragment,null,o?i.a.createElement(b.a,{message:"Hay un proceso en progreso, no deberia salir hasta que se complete. Est\xe1 seguro de salir?"}):null,i.a.createElement(b.e,null,i.a.createElement(b.c,{path:"/0",render:function(t){return i.a.createElement(ne,Object.assign({},t,{onValidate:e.handleValidateStep,onMounted:e.handleActivateStep,onItemChange:e.handleItemChange,choosenItems:l,productList:n}))}}),i.a.createElement(b.c,{path:"/1",render:function(t){return i.a.createElement(ie,Object.assign({},t,{productList:n,onValidate:e.handleValidateStep,onMounted:e.handleActivateStep,onItemChange:e.handleItemChange,onInputChange:e.handleInputChange,items:l,nota:s,forma_pago:c}))}}),i.a.createElement(b.c,{path:"/2",render:function(t){return i.a.createElement(oe,Object.assign({},t,{onValidate:e.handleValidateStep,invoiceData:d,data:u,onInputChange:e.handleInputChange,onInvoiceDataChange:e.handleInvoiceDataChange,onMounted:e.handleActivateStep}))}}),i.a.createElement(b.c,{path:"/3",render:function(t){return i.a.createElement(re,Object.assign({},t,{onValidate:e.handleValidateStep,API_KEY:e.state.G_M_K,onMounted:e.handleActivateStep,onPositionChanged:e.handlePositionChanged,direccion:h,onInputChange:e.handleInputChange}))}}),i.a.createElement(b.c,{path:"/4",render:function(t){return i.a.createElement(le,Object.assign({},t,{ws:e.whatsAppURL(),onValidate:e.handleValidateStep,onMounted:e.handleGuardar,loading:o,error:m,saved:Boolean(p)}))}}),i.a.createElement(b.b,{exact:!0,from:"/",to:"/0"}),i.a.createElement(b.b,{exact:!0,from:"",to:"/0"})),ce.length===this.state.activeStep?null:i.a.createElement(de,{onClick:this.handleNextClick,disabled:Boolean(this.validateStep(this.state.activeStep)),activeStep:this.state.activeStep,errMsg:this.validateStep(this.state.activeStep)})))))}}]),t}(i.a.Component),de=Object(b.h)(function(e){return i.a.createElement("div",{style:{width:"calct(100% - 20px)",display:"flex",flexDirection:"row",textAlign:"center",margin:10,minHeight:40}},0===e.activeStep?null:i.a.createElement(g.a,{onClick:function(){e.history.push("/"+(e.activeStep-1))},title:"Regresar",color:"secondary",variant:"outlined"},i.a.createElement(v.c,null)),i.a.createElement(g.a,{onClick:function(){e.errMsg?alert(e.errMsg):e.history.push("/"+(e.activeStep+1));e.onClick()},disabled:e.disabled,color:"primary",type:"button",variant:"outlined",style:{flex:1},size:"large"},"CONTINUAR"))});var ue=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).state={begin:!0},a.begin=function(){return a.setState({begin:!1}),null!==j("geo")?a.props.launch():navigator.geolocation?void navigator.geolocation.getCurrentPosition(function(e){window.lat=e.coords.latitude,window.lon=e.coords.longitude,a.props.launch(),x("geo",!0)},function(e){e.code===e.PERMISSION_DENIED?a.setState({error:"No se ha podido establecer tu ubicaci\xf3n.",_error:e.message,code:e.code}):e.code===e.POSITION_UNAVAILABLE?a.setState({error:"Tu navegador no nos permite encontrar tu ubicaci\xf3n.",_error:e.message,code:e.code}):a.setState({error:e.message,code:e.code}),x("geo",!1)}):a.setState({error:"Tu navegador no soporta la funci\xf3n de Ubicaci\xf3n."})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;C.GetStoreData().then(function(t){e.setState(Object(c.a)({},t))}).catch(function(t){e.setState({error:t.message,code:t.code})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.logoSrc,n=t.slogan,o=t.titulo,r=t.error,l=t._error,c=t.begin;return i.a.createElement("div",{style:{width:"calc(100% - 20px)",maxWidth:600,textAlign:"center",paddingTop:30,margin:"auto"}},c?i.a.createElement(i.a.Fragment,null,a?i.a.createElement("img",{src:a,style:{maxWidth:"100%",maxHeight:350,marginTop:10,marginBottom:10}}):null,i.a.createElement(g.t,{variant:"h6"},o||"Cargando..."),n?i.a.createElement(g.t,{variant:"subtitle2"},n):null,i.a.createElement(g.a,{color:"primary",onClick:this.begin,fullWidth:!0,variant:"outlined",style:{marginTop:20}},"EMPECEMOS!")):r?i.a.createElement("div",{style:{width:"100%"}},i.a.createElement(v.h,{fontSize:"large"}),i.a.createElement(g.t,{variant:"body2"},r),i.a.createElement(g.t,{variant:"body1"},l),i.a.createElement(g.a,{style:{marginTop:20,wordWrap:"break-word"},onClick:function(){return e.props.launch()},variant:"outlined",color:"primary"},"ENTRAR DE TODAS FORMAS")):i.a.createElement("div",{style:{width:"100%"}},i.a.createElement(g.t,{variant:"h5"},"Primero necesitamos que nos permitas acceder a tu ubicaci\xf3n"),i.a.createElement(v.i,{fontSize:"large"})))}}]),t}(i.a.Component);r.a.render(i.a.createElement(ue,{launch:function(){return r.a.render(i.a.createElement(se,null),document.getElementById("app"))}}),document.getElementById("app"))}},[[5564,2,1]]]);
//# sourceMappingURL=main.5da9aa88.chunk.js.map